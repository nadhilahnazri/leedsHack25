{
  "version": 3,
  "sources": ["../../sdp-transform/lib/grammar.js", "../../sdp-transform/lib/parser.js", "../../sdp-transform/lib/writer.js", "../../sdp-transform/lib/index.js", "../../@pexip/socket-manager/dist/utils.js", "../../@pexip/socket-manager/dist/types.js", "../../@pexip/socket-manager/dist/constants.js", "../../@pexip/socket-manager/dist/baseLogger.js", "../../@pexip/socket-manager/dist/logger.js", "../../@pexip/socket-manager/dist/socketManager.js", "../../@pexip/vpaas-api/dist/baseLogger.js", "../../@pexip/vpaas-api/dist/logger.js", "../../@pexip/vpaas-api/dist/utils.js", "../../@pexip/vpaas-api/dist/api.js", "../../@pexip/peer-connection/dist/types.js", "../../@pexip/peer-connection/dist/baseLogger.js", "../../@pexip/peer-connection/dist/logger.js", "../../@pexip/peer-connection/dist/constants.js", "../../@pexip/peer-connection/dist/utils.js", "../../@pexip/peer-connection/dist/sdpManager.js", "../../@pexip/peer-connection/dist/peerConnections.js", "../../@pexip/vpaas-sdk/src/baseLogger.ts", "../../@pexip/vpaas-sdk/src/logger.ts", "../../@pexip/vpaas-sdk/src/constants.ts", "../../@pexip/vpaas-sdk/src/utils.ts", "../../@pexip/vpaas-sdk/src/call.ts", "../../@pexip/vpaas-sdk/src/types.ts", "../../@pexip/vpaas-sdk/src/vpaas.ts"],
  "sourcesContent": ["var grammar = module.exports = {\r\n  v: [{\r\n    name: 'version',\r\n    reg: /^(\\d*)$/\r\n  }],\r\n  o: [{\r\n    // o=- 20518 0 IN IP4 203.0.113.1\r\n    // NB: sessionId will be a String in most cases because it is huge\r\n    name: 'origin',\r\n    reg: /^(\\S*) (\\d*) (\\d*) (\\S*) IP(\\d) (\\S*)/,\r\n    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],\r\n    format: '%s %s %d %s IP%d %s'\r\n  }],\r\n  // default parsing of these only (though some of these feel outdated)\r\n  s: [{ name: 'name' }],\r\n  i: [{ name: 'description' }],\r\n  u: [{ name: 'uri' }],\r\n  e: [{ name: 'email' }],\r\n  p: [{ name: 'phone' }],\r\n  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly...\r\n  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly\r\n  // k: [{}], // outdated thing ignored\r\n  t: [{\r\n    // t=0 0\r\n    name: 'timing',\r\n    reg: /^(\\d*) (\\d*)/,\r\n    names: ['start', 'stop'],\r\n    format: '%d %d'\r\n  }],\r\n  c: [{\r\n    // c=IN IP4 10.47.197.26\r\n    name: 'connection',\r\n    reg: /^IN IP(\\d) (\\S*)/,\r\n    names: ['version', 'ip'],\r\n    format: 'IN IP%d %s'\r\n  }],\r\n  b: [{\r\n    // b=AS:4000\r\n    push: 'bandwidth',\r\n    reg: /^(TIAS|AS|CT|RR|RS):(\\d*)/,\r\n    names: ['type', 'limit'],\r\n    format: '%s:%s'\r\n  }],\r\n  m: [{\r\n    // m=video 51744 RTP/AVP 126 97 98 34 31\r\n    // NB: special - pushes to session\r\n    // TODO: rtp/fmtp should be filtered by the payloads found here?\r\n    reg: /^(\\w*) (\\d*) ([\\w/]*)(?: (.*))?/,\r\n    names: ['type', 'port', 'protocol', 'payloads'],\r\n    format: '%s %d %s %s'\r\n  }],\r\n  a: [\r\n    {\r\n      // a=rtpmap:110 opus/48000/2\r\n      push: 'rtp',\r\n      reg: /^rtpmap:(\\d*) ([\\w\\-.]*)(?:\\s*\\/(\\d*)(?:\\s*\\/(\\S*))?)?/,\r\n      names: ['payload', 'codec', 'rate', 'encoding'],\r\n      format: function (o) {\r\n        return (o.encoding)\r\n          ? 'rtpmap:%d %s/%s/%s'\r\n          : o.rate\r\n            ? 'rtpmap:%d %s/%s'\r\n            : 'rtpmap:%d %s';\r\n      }\r\n    },\r\n    {\r\n      // a=fmtp:108 profile-level-id=24;object=23;bitrate=64000\r\n      // a=fmtp:111 minptime=10; useinbandfec=1\r\n      push: 'fmtp',\r\n      reg: /^fmtp:(\\d*) ([\\S| ]*)/,\r\n      names: ['payload', 'config'],\r\n      format: 'fmtp:%d %s'\r\n    },\r\n    {\r\n      // a=control:streamid=0\r\n      name: 'control',\r\n      reg: /^control:(.*)/,\r\n      format: 'control:%s'\r\n    },\r\n    {\r\n      // a=rtcp:65179 IN IP4 193.84.77.194\r\n      name: 'rtcp',\r\n      reg: /^rtcp:(\\d*)(?: (\\S*) IP(\\d) (\\S*))?/,\r\n      names: ['port', 'netType', 'ipVer', 'address'],\r\n      format: function (o) {\r\n        return (o.address != null)\r\n          ? 'rtcp:%d %s IP%d %s'\r\n          : 'rtcp:%d';\r\n      }\r\n    },\r\n    {\r\n      // a=rtcp-fb:98 trr-int 100\r\n      push: 'rtcpFbTrrInt',\r\n      reg: /^rtcp-fb:(\\*|\\d*) trr-int (\\d*)/,\r\n      names: ['payload', 'value'],\r\n      format: 'rtcp-fb:%s trr-int %d'\r\n    },\r\n    {\r\n      // a=rtcp-fb:98 nack rpsi\r\n      push: 'rtcpFb',\r\n      reg: /^rtcp-fb:(\\*|\\d*) ([\\w-_]*)(?: ([\\w-_]*))?/,\r\n      names: ['payload', 'type', 'subtype'],\r\n      format: function (o) {\r\n        return (o.subtype != null)\r\n          ? 'rtcp-fb:%s %s %s'\r\n          : 'rtcp-fb:%s %s';\r\n      }\r\n    },\r\n    {\r\n      // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\r\n      // a=extmap:1/recvonly URI-gps-string\r\n      // a=extmap:3 urn:ietf:params:rtp-hdrext:encrypt urn:ietf:params:rtp-hdrext:smpte-tc 25@600/24\r\n      push: 'ext',\r\n      reg: /^extmap:(\\d+)(?:\\/(\\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\\S*)(?: (\\S*))?/,\r\n      names: ['value', 'direction', 'encrypt-uri', 'uri', 'config'],\r\n      format: function (o) {\r\n        return (\r\n          'extmap:%d' +\r\n          (o.direction ? '/%s' : '%v') +\r\n          (o['encrypt-uri'] ? ' %s' : '%v') +\r\n          ' %s' +\r\n          (o.config ? ' %s' : '')\r\n        );\r\n      }\r\n    },\r\n    {\r\n      // a=extmap-allow-mixed\r\n      name: 'extmapAllowMixed',\r\n      reg: /^(extmap-allow-mixed)/\r\n    },\r\n    {\r\n      // a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32\r\n      push: 'crypto',\r\n      reg: /^crypto:(\\d*) ([\\w_]*) (\\S*)(?: (\\S*))?/,\r\n      names: ['id', 'suite', 'config', 'sessionConfig'],\r\n      format: function (o) {\r\n        return (o.sessionConfig != null)\r\n          ? 'crypto:%d %s %s %s'\r\n          : 'crypto:%d %s %s';\r\n      }\r\n    },\r\n    {\r\n      // a=setup:actpass\r\n      name: 'setup',\r\n      reg: /^setup:(\\w*)/,\r\n      format: 'setup:%s'\r\n    },\r\n    {\r\n      // a=connection:new\r\n      name: 'connectionType',\r\n      reg: /^connection:(new|existing)/,\r\n      format: 'connection:%s'\r\n    },\r\n    {\r\n      // a=mid:1\r\n      name: 'mid',\r\n      reg: /^mid:([^\\s]*)/,\r\n      format: 'mid:%s'\r\n    },\r\n    {\r\n      // a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a\r\n      name: 'msid',\r\n      reg: /^msid:(.*)/,\r\n      format: 'msid:%s'\r\n    },\r\n    {\r\n      // a=ptime:20\r\n      name: 'ptime',\r\n      reg: /^ptime:(\\d*(?:\\.\\d*)*)/,\r\n      format: 'ptime:%d'\r\n    },\r\n    {\r\n      // a=maxptime:60\r\n      name: 'maxptime',\r\n      reg: /^maxptime:(\\d*(?:\\.\\d*)*)/,\r\n      format: 'maxptime:%d'\r\n    },\r\n    {\r\n      // a=sendrecv\r\n      name: 'direction',\r\n      reg: /^(sendrecv|recvonly|sendonly|inactive)/\r\n    },\r\n    {\r\n      // a=ice-lite\r\n      name: 'icelite',\r\n      reg: /^(ice-lite)/\r\n    },\r\n    {\r\n      // a=ice-ufrag:F7gI\r\n      name: 'iceUfrag',\r\n      reg: /^ice-ufrag:(\\S*)/,\r\n      format: 'ice-ufrag:%s'\r\n    },\r\n    {\r\n      // a=ice-pwd:x9cml/YzichV2+XlhiMu8g\r\n      name: 'icePwd',\r\n      reg: /^ice-pwd:(\\S*)/,\r\n      format: 'ice-pwd:%s'\r\n    },\r\n    {\r\n      // a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33\r\n      name: 'fingerprint',\r\n      reg: /^fingerprint:(\\S*) (\\S*)/,\r\n      names: ['type', 'hash'],\r\n      format: 'fingerprint:%s %s'\r\n    },\r\n    {\r\n      // a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host\r\n      // a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10\r\n      // a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10\r\n      // a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10\r\n      // a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10\r\n      push:'candidates',\r\n      reg: /^candidate:(\\S*) (\\d*) (\\S*) (\\d*) (\\S*) (\\d*) typ (\\S*)(?: raddr (\\S*) rport (\\d*))?(?: tcptype (\\S*))?(?: generation (\\d*))?(?: network-id (\\d*))?(?: network-cost (\\d*))?/,\r\n      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],\r\n      format: function (o) {\r\n        var str = 'candidate:%s %d %s %d %s %d typ %s';\r\n\r\n        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';\r\n\r\n        // NB: candidate has three optional chunks, so %void middles one if it's missing\r\n        str += (o.tcptype != null) ? ' tcptype %s' : '%v';\r\n\r\n        if (o.generation != null) {\r\n          str += ' generation %d';\r\n        }\r\n\r\n        str += (o['network-id'] != null) ? ' network-id %d' : '%v';\r\n        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';\r\n        return str;\r\n      }\r\n    },\r\n    {\r\n      // a=end-of-candidates (keep after the candidates line for readability)\r\n      name: 'endOfCandidates',\r\n      reg: /^(end-of-candidates)/\r\n    },\r\n    {\r\n      // a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...\r\n      name: 'remoteCandidates',\r\n      reg: /^remote-candidates:(.*)/,\r\n      format: 'remote-candidates:%s'\r\n    },\r\n    {\r\n      // a=ice-options:google-ice\r\n      name: 'iceOptions',\r\n      reg: /^ice-options:(\\S*)/,\r\n      format: 'ice-options:%s'\r\n    },\r\n    {\r\n      // a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1\r\n      push: 'ssrcs',\r\n      reg: /^ssrc:(\\d*) ([\\w_-]*)(?::(.*))?/,\r\n      names: ['id', 'attribute', 'value'],\r\n      format: function (o) {\r\n        var str = 'ssrc:%d';\r\n        if (o.attribute != null) {\r\n          str += ' %s';\r\n          if (o.value != null) {\r\n            str += ':%s';\r\n          }\r\n        }\r\n        return str;\r\n      }\r\n    },\r\n    {\r\n      // a=ssrc-group:FEC 1 2\r\n      // a=ssrc-group:FEC-FR 3004364195 1080772241\r\n      push: 'ssrcGroups',\r\n      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E\r\n      reg: /^ssrc-group:([\\x21\\x23\\x24\\x25\\x26\\x27\\x2A\\x2B\\x2D\\x2E\\w]*) (.*)/,\r\n      names: ['semantics', 'ssrcs'],\r\n      format: 'ssrc-group:%s %s'\r\n    },\r\n    {\r\n      // a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV\r\n      name: 'msidSemantic',\r\n      reg: /^msid-semantic:\\s?(\\w*) (\\S*)/,\r\n      names: ['semantic', 'token'],\r\n      format: 'msid-semantic: %s %s' // space after ':' is not accidental\r\n    },\r\n    {\r\n      // a=group:BUNDLE audio video\r\n      push: 'groups',\r\n      reg: /^group:(\\w*) (.*)/,\r\n      names: ['type', 'mids'],\r\n      format: 'group:%s %s'\r\n    },\r\n    {\r\n      // a=rtcp-mux\r\n      name: 'rtcpMux',\r\n      reg: /^(rtcp-mux)/\r\n    },\r\n    {\r\n      // a=rtcp-rsize\r\n      name: 'rtcpRsize',\r\n      reg: /^(rtcp-rsize)/\r\n    },\r\n    {\r\n      // a=sctpmap:5000 webrtc-datachannel 1024\r\n      name: 'sctpmap',\r\n      reg: /^sctpmap:([\\w_/]*) (\\S*)(?: (\\S*))?/,\r\n      names: ['sctpmapNumber', 'app', 'maxMessageSize'],\r\n      format: function (o) {\r\n        return (o.maxMessageSize != null)\r\n          ? 'sctpmap:%s %s %s'\r\n          : 'sctpmap:%s %s';\r\n      }\r\n    },\r\n    {\r\n      // a=x-google-flag:conference\r\n      name: 'xGoogleFlag',\r\n      reg: /^x-google-flag:([^\\s]*)/,\r\n      format: 'x-google-flag:%s'\r\n    },\r\n    {\r\n      // a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0\r\n      push: 'rids',\r\n      reg: /^rid:([\\d\\w]+) (\\w+)(?: ([\\S| ]*))?/,\r\n      names: ['id', 'direction', 'params'],\r\n      format: function (o) {\r\n        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';\r\n      }\r\n    },\r\n    {\r\n      // a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]\r\n      // a=imageattr:* send [x=800,y=640] recv *\r\n      // a=imageattr:100 recv [x=320,y=240]\r\n      push: 'imageattrs',\r\n      reg: new RegExp(\r\n        // a=imageattr:97\r\n        '^imageattr:(\\\\d+|\\\\*)' +\r\n        // send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]\r\n        '[\\\\s\\\\t]+(send|recv)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*)' +\r\n        // recv [x=330,y=250]\r\n        '(?:[\\\\s\\\\t]+(recv|send)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*))?'\r\n      ),\r\n      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],\r\n      format: function (o) {\r\n        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');\r\n      }\r\n    },\r\n    {\r\n      // a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8\r\n      // a=simulcast:recv 1;4,5 send 6;7\r\n      name: 'simulcast',\r\n      reg: new RegExp(\r\n        // a=simulcast:\r\n        '^simulcast:' +\r\n        // send 1,2,3;~4,~5\r\n        '(send|recv) ([a-zA-Z0-9\\\\-_~;,]+)' +\r\n        // space + recv 6;~7,~8\r\n        '(?:\\\\s?(send|recv) ([a-zA-Z0-9\\\\-_~;,]+))?' +\r\n        // end\r\n        '$'\r\n      ),\r\n      names: ['dir1', 'list1', 'dir2', 'list2'],\r\n      format: function (o) {\r\n        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');\r\n      }\r\n    },\r\n    {\r\n      // old simulcast draft 03 (implemented by Firefox)\r\n      //   https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03\r\n      // a=simulcast: recv pt=97;98 send pt=97\r\n      // a=simulcast: send rid=5;6;7 paused=6,7\r\n      name: 'simulcast_03',\r\n      reg: /^simulcast:[\\s\\t]+([\\S+\\s\\t]+)$/,\r\n      names: ['value'],\r\n      format: 'simulcast: %s'\r\n    },\r\n    {\r\n      // a=framerate:25\r\n      // a=framerate:29.97\r\n      name: 'framerate',\r\n      reg: /^framerate:(\\d+(?:$|\\.\\d+))/,\r\n      format: 'framerate:%s'\r\n    },\r\n    {\r\n      // RFC4570\r\n      // a=source-filter: incl IN IP4 239.5.2.31 10.1.15.5\r\n      name: 'sourceFilter',\r\n      reg: /^source-filter: *(excl|incl) (\\S*) (IP4|IP6|\\*) (\\S*) (.*)/,\r\n      names: ['filterMode', 'netType', 'addressTypes', 'destAddress', 'srcList'],\r\n      format: 'source-filter: %s %s %s %s %s'\r\n    },\r\n    {\r\n      // a=bundle-only\r\n      name: 'bundleOnly',\r\n      reg: /^(bundle-only)/\r\n    },\r\n    {\r\n      // a=label:1\r\n      name: 'label',\r\n      reg: /^label:(.+)/,\r\n      format: 'label:%s'\r\n    },\r\n    {\r\n      // RFC version 26 for SCTP over DTLS\r\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-5\r\n      name: 'sctpPort',\r\n      reg: /^sctp-port:(\\d+)$/,\r\n      format: 'sctp-port:%s'\r\n    },\r\n    {\r\n      // RFC version 26 for SCTP over DTLS\r\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-6\r\n      name: 'maxMessageSize',\r\n      reg: /^max-message-size:(\\d+)$/,\r\n      format: 'max-message-size:%s'\r\n    },\r\n    {\r\n      // RFC7273\r\n      // a=ts-refclk:ptp=IEEE1588-2008:39-A7-94-FF-FE-07-CB-D0:37\r\n      push:'tsRefClocks',\r\n      reg: /^ts-refclk:([^\\s=]*)(?:=(\\S*))?/,\r\n      names: ['clksrc', 'clksrcExt'],\r\n      format: function (o) {\r\n        return 'ts-refclk:%s' + (o.clksrcExt != null ? '=%s' : '');\r\n      }\r\n    },\r\n    {\r\n      // RFC7273\r\n      // a=mediaclk:direct=963214424\r\n      name:'mediaClk',\r\n      reg: /^mediaclk:(?:id=(\\S*))? *([^\\s=]*)(?:=(\\S*))?(?: *rate=(\\d+)\\/(\\d+))?/,\r\n      names: ['id', 'mediaClockName', 'mediaClockValue', 'rateNumerator', 'rateDenominator'],\r\n      format: function (o) {\r\n        var str = 'mediaclk:';\r\n        str += (o.id != null ? 'id=%s %s' : '%v%s');\r\n        str += (o.mediaClockValue != null ? '=%s' : '');\r\n        str += (o.rateNumerator != null ? ' rate=%s' : '');\r\n        str += (o.rateDenominator != null ? '/%s' : '');\r\n        return str;\r\n      }\r\n    },\r\n    {\r\n      // a=keywds:keywords\r\n      name: 'keywords',\r\n      reg: /^keywds:(.+)$/,\r\n      format: 'keywds:%s'\r\n    },\r\n    {\r\n      // a=content:main\r\n      name: 'content',\r\n      reg: /^content:(.+)/,\r\n      format: 'content:%s'\r\n    },\r\n    // BFCP https://tools.ietf.org/html/rfc4583\r\n    {\r\n      // a=floorctrl:c-s\r\n      name: 'bfcpFloorCtrl',\r\n      reg: /^floorctrl:(c-only|s-only|c-s)/,\r\n      format: 'floorctrl:%s'\r\n    },\r\n    {\r\n      // a=confid:1\r\n      name: 'bfcpConfId',\r\n      reg: /^confid:(\\d+)/,\r\n      format: 'confid:%s'\r\n    },\r\n    {\r\n      // a=userid:1\r\n      name: 'bfcpUserId',\r\n      reg: /^userid:(\\d+)/,\r\n      format: 'userid:%s'\r\n    },\r\n    {\r\n      // a=floorid:1\r\n      name: 'bfcpFloorId',\r\n      reg: /^floorid:(.+) (?:m-stream|mstrm):(.+)/,\r\n      names: ['id', 'mStream'],\r\n      format: 'floorid:%s mstrm:%s'\r\n    },\r\n    {\r\n      // any a= that we don't understand is kept verbatim on media.invalid\r\n      push: 'invalid',\r\n      names: ['value']\r\n    }\r\n  ]\r\n};\r\n\r\n// set sensible defaults to avoid polluting the grammar with boring details\r\nObject.keys(grammar).forEach(function (key) {\r\n  var objs = grammar[key];\r\n  objs.forEach(function (obj) {\r\n    if (!obj.reg) {\r\n      obj.reg = /(.*)/;\r\n    }\r\n    if (!obj.format) {\r\n      obj.format = '%s';\r\n    }\r\n  });\r\n});\r\n", "var toIntIfInt = function (v) {\r\n  return String(Number(v)) === v ? Number(v) : v;\r\n};\r\n\r\nvar attachProperties = function (match, location, names, rawName) {\r\n  if (rawName && !names) {\r\n    location[rawName] = toIntIfInt(match[1]);\r\n  }\r\n  else {\r\n    for (var i = 0; i < names.length; i += 1) {\r\n      if (match[i+1] != null) {\r\n        location[names[i]] = toIntIfInt(match[i+1]);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nvar parseReg = function (obj, location, content) {\r\n  var needsBlank = obj.name && obj.names;\r\n  if (obj.push && !location[obj.push]) {\r\n    location[obj.push] = [];\r\n  }\r\n  else if (needsBlank && !location[obj.name]) {\r\n    location[obj.name] = {};\r\n  }\r\n  var keyLocation = obj.push ?\r\n    {} :  // blank object that will be pushed\r\n    needsBlank ? location[obj.name] : location; // otherwise, named location or root\r\n\r\n  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);\r\n\r\n  if (obj.push) {\r\n    location[obj.push].push(keyLocation);\r\n  }\r\n};\r\n\r\nvar grammar = require('./grammar');\r\nvar validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);\r\n\r\nexports.parse = function (sdp) {\r\n  var session = {}\r\n    , media = []\r\n    , location = session; // points at where properties go under (one of the above)\r\n\r\n  // parse lines we understand\r\n  sdp.split(/(\\r\\n|\\r|\\n)/).filter(validLine).forEach(function (l) {\r\n    var type = l[0];\r\n    var content = l.slice(2);\r\n    if (type === 'm') {\r\n      media.push({rtp: [], fmtp: []});\r\n      location = media[media.length-1]; // point at latest media line\r\n    }\r\n\r\n    for (var j = 0; j < (grammar[type] || []).length; j += 1) {\r\n      var obj = grammar[type][j];\r\n      if (obj.reg.test(content)) {\r\n        return parseReg(obj, location, content);\r\n      }\r\n    }\r\n  });\r\n\r\n  session.media = media; // link it up\r\n  return session;\r\n};\r\n\r\nvar paramReducer = function (acc, expr) {\r\n  var s = expr.split(/=(.+)/, 2);\r\n  if (s.length === 2) {\r\n    acc[s[0]] = toIntIfInt(s[1]);\r\n  } else if (s.length === 1 && expr.length > 1) {\r\n    acc[s[0]] = undefined;\r\n  }\r\n  return acc;\r\n};\r\n\r\nexports.parseParams = function (str) {\r\n  return str.split(/;\\s?/).reduce(paramReducer, {});\r\n};\r\n\r\n// For backward compatibility - alias will be removed in 3.0.0\r\nexports.parseFmtpConfig = exports.parseParams;\r\n\r\nexports.parsePayloads = function (str) {\r\n  return str.toString().split(' ').map(Number);\r\n};\r\n\r\nexports.parseRemoteCandidates = function (str) {\r\n  var candidates = [];\r\n  var parts = str.split(' ').map(toIntIfInt);\r\n  for (var i = 0; i < parts.length; i += 3) {\r\n    candidates.push({\r\n      component: parts[i],\r\n      ip: parts[i + 1],\r\n      port: parts[i + 2]\r\n    });\r\n  }\r\n  return candidates;\r\n};\r\n\r\nexports.parseImageAttributes = function (str) {\r\n  return str.split(' ').map(function (item) {\r\n    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});\r\n  });\r\n};\r\n\r\nexports.parseSimulcastStreamList = function (str) {\r\n  return str.split(';').map(function (stream) {\r\n    return stream.split(',').map(function (format) {\r\n      var scid, paused = false;\r\n\r\n      if (format[0] !== '~') {\r\n        scid = toIntIfInt(format);\r\n      } else {\r\n        scid = toIntIfInt(format.substring(1, format.length));\r\n        paused = true;\r\n      }\r\n\r\n      return {\r\n        scid: scid,\r\n        paused: paused\r\n      };\r\n    });\r\n  });\r\n};\r\n", "var grammar = require('./grammar');\r\n\r\n// customized util.format - discards excess arguments and can void middle ones\r\nvar formatRegExp = /%[sdv%]/g;\r\nvar format = function (formatStr) {\r\n  var i = 1;\r\n  var args = arguments;\r\n  var len = args.length;\r\n  return formatStr.replace(formatRegExp, function (x) {\r\n    if (i >= len) {\r\n      return x; // missing argument\r\n    }\r\n    var arg = args[i];\r\n    i += 1;\r\n    switch (x) {\r\n    case '%%':\r\n      return '%';\r\n    case '%s':\r\n      return String(arg);\r\n    case '%d':\r\n      return Number(arg);\r\n    case '%v':\r\n      return '';\r\n    }\r\n  });\r\n  // NB: we discard excess arguments - they are typically undefined from makeLine\r\n};\r\n\r\nvar makeLine = function (type, obj, location) {\r\n  var str = obj.format instanceof Function ?\r\n    (obj.format(obj.push ? location : location[obj.name])) :\r\n    obj.format;\r\n\r\n  var args = [type + '=' + str];\r\n  if (obj.names) {\r\n    for (var i = 0; i < obj.names.length; i += 1) {\r\n      var n = obj.names[i];\r\n      if (obj.name) {\r\n        args.push(location[obj.name][n]);\r\n      }\r\n      else { // for mLine and push attributes\r\n        args.push(location[obj.names[i]]);\r\n      }\r\n    }\r\n  }\r\n  else {\r\n    args.push(location[obj.name]);\r\n  }\r\n  return format.apply(null, args);\r\n};\r\n\r\n// RFC specified order\r\n// TODO: extend this with all the rest\r\nvar defaultOuterOrder = [\r\n  'v', 'o', 's', 'i',\r\n  'u', 'e', 'p', 'c',\r\n  'b', 't', 'r', 'z', 'a'\r\n];\r\nvar defaultInnerOrder = ['i', 'c', 'b', 'a'];\r\n\r\n\r\nmodule.exports = function (session, opts) {\r\n  opts = opts || {};\r\n  // ensure certain properties exist\r\n  if (session.version == null) {\r\n    session.version = 0; // 'v=0' must be there (only defined version atm)\r\n  }\r\n  if (session.name == null) {\r\n    session.name = ' '; // 's= ' must be there if no meaningful name set\r\n  }\r\n  session.media.forEach(function (mLine) {\r\n    if (mLine.payloads == null) {\r\n      mLine.payloads = '';\r\n    }\r\n  });\r\n\r\n  var outerOrder = opts.outerOrder || defaultOuterOrder;\r\n  var innerOrder = opts.innerOrder || defaultInnerOrder;\r\n  var sdp = [];\r\n\r\n  // loop through outerOrder for matching properties on session\r\n  outerOrder.forEach(function (type) {\r\n    grammar[type].forEach(function (obj) {\r\n      if (obj.name in session && session[obj.name] != null) {\r\n        sdp.push(makeLine(type, obj, session));\r\n      }\r\n      else if (obj.push in session && session[obj.push] != null) {\r\n        session[obj.push].forEach(function (el) {\r\n          sdp.push(makeLine(type, obj, el));\r\n        });\r\n      }\r\n    });\r\n  });\r\n\r\n  // then for each media line, follow the innerOrder\r\n  session.media.forEach(function (mLine) {\r\n    sdp.push(makeLine('m', grammar.m[0], mLine));\r\n\r\n    innerOrder.forEach(function (type) {\r\n      grammar[type].forEach(function (obj) {\r\n        if (obj.name in mLine && mLine[obj.name] != null) {\r\n          sdp.push(makeLine(type, obj, mLine));\r\n        }\r\n        else if (obj.push in mLine && mLine[obj.push] != null) {\r\n          mLine[obj.push].forEach(function (el) {\r\n            sdp.push(makeLine(type, obj, el));\r\n          });\r\n        }\r\n      });\r\n    });\r\n  });\r\n\r\n  return sdp.join('\\r\\n') + '\\r\\n';\r\n};\r\n", "var parser = require('./parser');\r\nvar writer = require('./writer');\r\n\r\nexports.write = writer;\r\nexports.parse = parser.parse;\r\nexports.parseParams = parser.parseParams;\r\nexports.parseFmtpConfig = parser.parseFmtpConfig; // Alias of parseParams().\r\nexports.parsePayloads = parser.parsePayloads;\r\nexports.parseRemoteCandidates = parser.parseRemoteCandidates;\r\nexports.parseImageAttributes = parser.parseImageAttributes;\r\nexports.parseSimulcastStreamList = parser.parseSimulcastStreamList;\r\n", "import { createSignal } from '@pexip/signal';\r\n/**\r\n *  indicates wether the given close code in the error range\r\n *\r\n * @param WebSocket-internal error code\r\n *\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent\r\n */\r\nexport const isWebSocketClosedWithError = (errorCode) => errorCode > 1000 && errorCode < 1017;\r\nexport const isOpen = (readyState) => readyState === WebSocket.OPEN;\r\nexport const isClosed = (readyState) => readyState === WebSocket.CLOSED;\r\nexport const isConnecting = (readyState) => readyState === WebSocket.CONNECTING;\r\n/**\r\n * Create a general signal with consistent scoped name\r\n *\r\n * @param name - Signal name\r\n * @param scope - The scope of the signal for better logging\r\n * @param variant - The variant of the signal @see Signal @defaultValue 'generic'\r\n */\r\nconst createSocketSignal = (name, scope = '', variant = 'generic') => createSignal({\r\n    name: `socket-manager/${scope ? `${scope}/` : ''}${name}`,\r\n    allowEmittingWithoutObserver: allowEmittingWithoutObserver(name),\r\n    variant,\r\n});\r\nconst allowEmittingWithoutObserver = (signal) => [\r\n    'onConnecting',\r\n    'onConnected',\r\n    'onReconnecting',\r\n    'onReconnected',\r\n    'onDisconnected',\r\n    'onError',\r\n    'onMessage',\r\n].includes(signal);\r\nconst REQUIRED_SOCKET_SIGNAL_KEYS = [\r\n    'onConnecting',\r\n    'onConnected',\r\n    'onReconnecting',\r\n    'onReconnected',\r\n    'onDisconnected',\r\n    'onError',\r\n    'onMessage',\r\n];\r\n/**\r\n * Create and return all required and optional (if specified with `more`),\r\n * signals for call to work\r\n *\r\n * @param scope - any scope prefix for the generated signal name, @see Signal\r\n * @param more - Keys from `SocketSignalsOptional`, @see SocketSignalsOptional\r\n *\r\n * The following signals created by default\r\n * - 'onRemoteStream',\r\n *\r\n * @see REQUIRED_SOCKET_SIGNAL_KEYS\r\n */\r\nexport const createSocketSignals = (scope = '') => {\r\n    return REQUIRED_SOCKET_SIGNAL_KEYS.reduce((signals, key) => ({\r\n        ...signals,\r\n        [key]: createSocketSignal(key, scope),\r\n    }), {});\r\n};\r\n", "/**\r\n *  Status Codes for Websocket close\r\n *\r\n *  @see {@link https://datatracker.ietf.org/doc/html/rfc6455#section-7.4.1|RFC 6455}\r\n */\r\nexport var SocketCloseEventCode;\r\n(function (SocketCloseEventCode) {\r\n    SocketCloseEventCode[SocketCloseEventCode[\"NormalClosure\"] = 1000] = \"NormalClosure\";\r\n    SocketCloseEventCode[SocketCloseEventCode[\"GoingAway\"] = 1001] = \"GoingAway\";\r\n    SocketCloseEventCode[SocketCloseEventCode[\"AbnormalClosure\"] = 1006] = \"AbnormalClosure\";\r\n    SocketCloseEventCode[SocketCloseEventCode[\"Reconnect\"] = 4000] = \"Reconnect\";\r\n    SocketCloseEventCode[SocketCloseEventCode[\"Finalize\"] = 4999] = \"Finalize\";\r\n})(SocketCloseEventCode || (SocketCloseEventCode = {}));\r\n", "export const MAX_RECONNECT_ATTEMPTS = 8;\r\nexport const BACKOFF_BASE_SETTINGS = { min: 100, max: 30000, jitter: 0.2 };\r\n", "export var LogLevels;\r\n(function (LogLevels) {\r\n    LogLevels[LogLevels[\"trace\"] = 10] = \"trace\";\r\n    LogLevels[LogLevels[\"debug\"] = 20] = \"debug\";\r\n    LogLevels[LogLevels[\"info\"] = 30] = \"info\";\r\n    LogLevels[LogLevels[\"warn\"] = 40] = \"warn\";\r\n    LogLevels[LogLevels[\"error\"] = 50] = \"error\";\r\n    LogLevels[LogLevels[\"fatal\"] = 60] = \"fatal\";\r\n    // eslint-disable-next-line @typescript-eslint/prefer-literal-enum-member -- needs infinity\r\n    LogLevels[LogLevels[\"silent\"] = Number.MAX_SAFE_INTEGER] = \"silent\";\r\n})(LogLevels || (LogLevels = {}));\r\n/**\r\n * Create a logger with console API, and map fatal to error, skipping trace\r\n * and silent, and there is no redaction\r\n */\r\nexport function createConsoleLogger() {\r\n    return Object.freeze({\r\n        /* eslint-disable no-console -- set logger to console */\r\n        fatal: (meta, message) => console.error(message, meta),\r\n        error: (meta, message) => console.error(message, meta),\r\n        warn: (meta, message) => console.warn(message, meta),\r\n        info: (meta, message) => console.info(message, meta),\r\n        debug: (meta, message) => console.debug(message, meta),\r\n        trace() { }, // Noop\r\n        silent() { }, // Noop\r\n        redact() { }, // Noop\r\n        /* eslint-enable no-console -- set logger to console */\r\n    });\r\n}\r\n", "import { createConsoleLogger } from './baseLogger';\r\nexport let logger = createConsoleLogger();\r\nexport const setLogger = (newLogger) => {\r\n    logger = newLogger;\r\n};\r\n", "import { v4 as uuid } from 'uuid';\r\nimport { Backoff } from '@pexip/utils';\r\nimport { BACKOFF_BASE_SETTINGS, MAX_RECONNECT_ATTEMPTS } from './constants';\r\nimport { logger } from './logger';\r\nimport { SocketCloseEventCode } from './types';\r\nimport { isClosed, isConnecting, isOpen, isWebSocketClosedWithError, } from './utils';\r\nexport const createSocketManager = (signals, maxReconnectAttempts = MAX_RECONNECT_ATTEMPTS) => {\r\n    let ws;\r\n    let reconnectTimmer;\r\n    let reconnectAttempt = 0;\r\n    const _connect = (url, protocols, backoff = new Backoff(BACKOFF_BASE_SETTINGS)) => {\r\n        clearTimeout(reconnectTimmer);\r\n        if (isOpen(ws?.readyState)) {\r\n            logger.warn('Connection already established.');\r\n            return;\r\n        }\r\n        ws = new window.WebSocket(url, protocols);\r\n        window.pexDebug = { ...window.pexDebug, ws };\r\n        if (reconnectAttempt === 0) {\r\n            signals.onConnecting.emit();\r\n        }\r\n        else {\r\n            signals.onReconnecting.emit();\r\n        }\r\n        ws.onopen = event => {\r\n            logger.info({ event }, 'Connection opened');\r\n            if (reconnectAttempt === 0) {\r\n                signals.onConnected.emit();\r\n            }\r\n            else {\r\n                signals.onReconnected.emit();\r\n                reconnectAttempt = 0;\r\n                backoff.reset();\r\n            }\r\n        };\r\n        ws.onmessage = (msg) => {\r\n            try {\r\n                const event = JSON.parse(msg.data);\r\n                if ('token' in event && typeof event.token === 'string') {\r\n                    logger.redact(event.token);\r\n                }\r\n                logger[event.type === 'error' ? 'error' : 'debug']({ event }, `Message received with type ${event.type}`);\r\n                signals.onMessage.emit(event);\r\n            }\r\n            catch (error) {\r\n                logger.error({ error }, 'Parsing message failed');\r\n            }\r\n        };\r\n        ws.onerror = error => {\r\n            logger.error({ error }, 'Connection error');\r\n            signals.onError.emit();\r\n        };\r\n        ws.onclose = event => {\r\n            if (isWebSocketClosedWithError(event.code) &&\r\n                reconnectAttempt < maxReconnectAttempts) {\r\n                logger.error({ event }, 'Connection closed with error, reconnecting');\r\n                reconnectAttempt += 1;\r\n                reconnectTimmer = window.setTimeout(() => {\r\n                    _connect(url, protocols, backoff);\r\n                }, backoff.duration());\r\n            }\r\n            else {\r\n                logger.error({ event }, 'Connection closed');\r\n                signals.onDisconnected.emit(event);\r\n            }\r\n        };\r\n    };\r\n    const connect = async ({ abortController, url, }) => {\r\n        return new Promise((resolve, reject) => {\r\n            if (abortController?.signal?.aborted) {\r\n                return reject(abortController?.signal.reason);\r\n            }\r\n            const handleAbort = () => {\r\n                if (isConnecting(ws?.readyState)) {\r\n                    disconnect(SocketCloseEventCode.NormalClosure);\r\n                }\r\n                reject(abortController?.signal.reason);\r\n            };\r\n            abortController?.signal.addEventListener('abort', handleAbort, {\r\n                once: true,\r\n            });\r\n            const withAbortController = (fn) => (args) => {\r\n                abortController?.signal.removeEventListener('abort', handleAbort);\r\n                fn(args);\r\n            };\r\n            signals.onConnected.addOnce(withAbortController(resolve));\r\n            signals.onError.addOnce(withAbortController(reject));\r\n            _connect(url);\r\n        });\r\n    };\r\n    const disconnect = (code, reason) => {\r\n        ws?.close(code, reason);\r\n    };\r\n    const send = (data) => {\r\n        if (!data.id) {\r\n            data.id = uuid();\r\n        }\r\n        if ('token' in data && typeof data.token === 'string') {\r\n            logger.redact(data.token);\r\n        }\r\n        if (isClosed(ws?.readyState)) {\r\n            logger.warn({ data }, 'Websocket closed. Ignoring sending data');\r\n            return;\r\n        }\r\n        ws?.send(JSON.stringify(data));\r\n        logger.debug({ data }, `Message sent with type ${data.type}`);\r\n        return data.id;\r\n    };\r\n    return {\r\n        connect,\r\n        disconnect,\r\n        send,\r\n        get readyState() {\r\n            return ws?.readyState;\r\n        },\r\n        get bufferedAmount() {\r\n            return ws?.bufferedAmount;\r\n        },\r\n    };\r\n};\r\n", "export var LogLevels;\r\n(function (LogLevels) {\r\n    LogLevels[LogLevels[\"trace\"] = 10] = \"trace\";\r\n    LogLevels[LogLevels[\"debug\"] = 20] = \"debug\";\r\n    LogLevels[LogLevels[\"info\"] = 30] = \"info\";\r\n    LogLevels[LogLevels[\"warn\"] = 40] = \"warn\";\r\n    LogLevels[LogLevels[\"error\"] = 50] = \"error\";\r\n    LogLevels[LogLevels[\"fatal\"] = 60] = \"fatal\";\r\n    // eslint-disable-next-line @typescript-eslint/prefer-literal-enum-member -- needs infinity\r\n    LogLevels[LogLevels[\"silent\"] = Number.MAX_SAFE_INTEGER] = \"silent\";\r\n})(LogLevels || (LogLevels = {}));\r\n/**\r\n * Create a logger with console API, and map fatal to error, skipping trace\r\n * and silent, and there is no redaction\r\n */\r\nexport function createConsoleLogger() {\r\n    return Object.freeze({\r\n        /* eslint-disable no-console -- set logger to console */\r\n        fatal: (meta, message) => console.error(message, meta),\r\n        error: (meta, message) => console.error(message, meta),\r\n        warn: (meta, message) => console.warn(message, meta),\r\n        info: (meta, message) => console.info(message, meta),\r\n        debug: (meta, message) => console.debug(message, meta),\r\n        trace() { }, // Noop\r\n        silent() { }, // Noop\r\n        redact() { }, // Noop\r\n        /* eslint-enable no-console -- set logger to console */\r\n    });\r\n}\r\n", "// eslint-disable-next-line import/no-relative-packages -- false positive\r\nimport { createConsoleLogger } from './baseLogger.js';\r\nexport let logger = createConsoleLogger();\r\nexport const setLogger = (newLogger) => {\r\n    logger = newLogger;\r\n};\r\n", "export var ContentType;\r\n(function (ContentType) {\r\n    ContentType[\"JSON\"] = \"application/json\";\r\n    ContentType[\"FORM_URLENCODED\"] = \"application/x-www-form-urlencoded\";\r\n})(ContentType || (ContentType = {}));\r\nexport var HEADER;\r\n(function (HEADER) {\r\n    HEADER[\"ACCEPT\"] = \"Accept\";\r\n    HEADER[\"CONTENT_TYPE\"] = \"Content-Type\";\r\n    HEADER[\"AUTHORIZATION\"] = \"Authorization\";\r\n})(HEADER || (HEADER = {}));\r\nexport { setLogger } from './logger.js';\r\n", "import { logger } from './logger.js';\r\nimport { ContentType, HEADER } from './utils.js';\r\nexport class BadRequestError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'BadRequestError';\r\n    }\r\n}\r\nexport class UnauthorizedError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'UnauthorizedError';\r\n    }\r\n}\r\nexport class ForbiddenError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'ForbiddenError';\r\n    }\r\n}\r\nexport class NotFoundError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'NotFoundError';\r\n    }\r\n}\r\nexport class GoneError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'GoneError';\r\n    }\r\n}\r\nexport class ServiceUnavailableError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'ServiceUnavailableError';\r\n    }\r\n}\r\nexport class InternalServerError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'InternalServerError';\r\n    }\r\n}\r\nexport class NotModifiedError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'NotModifiedError';\r\n    }\r\n}\r\nexport class UnknownError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = 'UnknownError';\r\n    }\r\n}\r\n/**\r\n * Creates MEE api wrapper for the given `apiAddress` and `token`\r\n *\r\n * @privateRemarks  This will be generated from OpenApi schema\r\n *\r\n * @returns Api wrapper with all the main CRUD fns\r\n */\r\nexport const createApi = () => {\r\n    const getPath = (apiAddress) => (path) => `${apiAddress}/v1/meetings${path}`;\r\n    const fetcher = async (...args) => {\r\n        const [path, init] = args;\r\n        const printableUrl = typeof path === 'string' ? path : '';\r\n        logger.debug(`Fetching ${printableUrl}`);\r\n        const res = await fetch(path, init);\r\n        const data = (await res.json());\r\n        if ('token' in data && typeof data.token === 'string') {\r\n            logger.redact(data.token);\r\n        }\r\n        if ('participant_secret' in data &&\r\n            typeof data.participant_secret === 'string') {\r\n            logger.redact(data.participant_secret);\r\n        }\r\n        logger.debug({ res, data }, `Data for ${printableUrl}`);\r\n        return { status: res.status, data };\r\n    };\r\n    const token = async ({ abortSignal, apiAddress, token, headers, }) => {\r\n        const { data, status } = await fetcher(`${apiAddress}/oauth/token`, {\r\n            method: 'POST',\r\n            body: new URLSearchParams({\r\n                grant_type: 'client_credentials',\r\n                client_assertion_type: 'urn:ietf:params:oauth:client-assertion-type:jwt-bearer',\r\n                client_assertion: token,\r\n            }),\r\n            signal: abortSignal,\r\n            headers: {\r\n                [HEADER.CONTENT_TYPE]: ContentType.FORM_URLENCODED,\r\n                [HEADER.ACCEPT]: ContentType.JSON,\r\n                ...headers,\r\n            },\r\n        });\r\n        switch (status) {\r\n            case 200:\r\n                return { data, status };\r\n            case 400:\r\n                throw new BadRequestError(data.reason);\r\n            case 500:\r\n                throw new InternalServerError(data.reason);\r\n            default:\r\n                throw new UnknownError('');\r\n        }\r\n    };\r\n    const create = async ({ abortSignal, apiAddress, accessToken, headers, }) => {\r\n        const { data, status } = await fetcher(getPath(apiAddress)(''), {\r\n            method: 'POST',\r\n            body: JSON.stringify({}),\r\n            signal: abortSignal,\r\n            headers: {\r\n                [HEADER.CONTENT_TYPE]: ContentType.JSON,\r\n                ...(accessToken && { [HEADER.AUTHORIZATION]: accessToken }),\r\n                ...headers,\r\n            },\r\n        });\r\n        switch (status) {\r\n            case 200:\r\n                return { data, status };\r\n            case 400:\r\n                throw new BadRequestError(data.reason);\r\n            case 401:\r\n                throw new UnauthorizedError(data.reason);\r\n            case 403:\r\n                throw new ForbiddenError(data.reason);\r\n            case 404:\r\n                throw new NotFoundError(data.reason);\r\n            case 500:\r\n                throw new InternalServerError(data.reason);\r\n            default:\r\n                throw new UnknownError('');\r\n        }\r\n    };\r\n    const participants = async ({ abortSignal, meetingId, apiAddress, accessToken, headers, }) => {\r\n        const { data, status } = await fetcher(getPath(apiAddress)(`/${meetingId}/participants`), {\r\n            method: 'POST',\r\n            body: JSON.stringify({}),\r\n            signal: abortSignal,\r\n            headers: {\r\n                [HEADER.CONTENT_TYPE]: ContentType.JSON,\r\n                ...(accessToken && { [HEADER.AUTHORIZATION]: accessToken }),\r\n                ...headers,\r\n            },\r\n        });\r\n        switch (status) {\r\n            case 200:\r\n                return { data, status };\r\n            case 400:\r\n                throw new BadRequestError(data.reason);\r\n            case 401:\r\n                throw new UnauthorizedError(data.reason);\r\n            case 403:\r\n                throw new ForbiddenError(data.reason);\r\n            case 404:\r\n                throw new NotFoundError(data.reason);\r\n            case 500:\r\n                throw new InternalServerError(data.reason);\r\n            default:\r\n                throw new UnknownError('');\r\n        }\r\n    };\r\n    const join = async ({ abortSignal, apiAddress, meetingId, participantId, participantSecret, headers, }) => {\r\n        const { data, status } = await fetcher(getPath(apiAddress)(`/${meetingId}/join`), {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                participant_id: participantId,\r\n                participant_secret: participantSecret,\r\n            }),\r\n            signal: abortSignal,\r\n            headers: {\r\n                [HEADER.CONTENT_TYPE]: ContentType.JSON,\r\n                ...headers,\r\n            },\r\n        });\r\n        switch (status) {\r\n            case 200:\r\n                return { data, status };\r\n            case 400:\r\n                throw new BadRequestError(data.reason);\r\n            case 404:\r\n                throw new NotFoundError(data.reason);\r\n            case 410:\r\n                throw new GoneError(data.reason);\r\n            case 500:\r\n                throw new InternalServerError(data.reason);\r\n            case 503:\r\n                throw new ServiceUnavailableError(data.reason);\r\n            default:\r\n                throw new UnknownError('');\r\n        }\r\n    };\r\n    const terminate = async ({ abortSignal, apiAddress, meetingId, accessToken, headers, }) => {\r\n        const { data, status } = await fetcher(getPath(apiAddress)(`/${meetingId}`), {\r\n            method: 'DELETE',\r\n            signal: abortSignal,\r\n            headers: {\r\n                ...(accessToken && { [HEADER.AUTHORIZATION]: accessToken }),\r\n                ...headers,\r\n            },\r\n        });\r\n        switch (status) {\r\n            case 200:\r\n                return { data, status };\r\n            case 304:\r\n                throw new NotFoundError('');\r\n            case 401:\r\n                throw new UnauthorizedError(data.reason);\r\n            case 403:\r\n                throw new ForbiddenError(data.reason);\r\n            case 404:\r\n                throw new NotFoundError(data.reason);\r\n            default:\r\n                throw new UnknownError('');\r\n        }\r\n    };\r\n    return {\r\n        token,\r\n        create,\r\n        join,\r\n        participants,\r\n        terminate,\r\n    };\r\n};\r\nconst ACCESS_EXP_BUFFER = 60000;\r\nexport const withToken = (createAndSignJWT, apiAddress) => (api) => {\r\n    let token;\r\n    let tokenReceivedDate;\r\n    const isTokenValid = () => Boolean(tokenReceivedDate &&\r\n        token?.expires_in &&\r\n        tokenReceivedDate +\r\n            token.expires_in * 1000 -\r\n            ACCESS_EXP_BUFFER >\r\n            Date.now());\r\n    const getAccessToken = () => `${token?.token_type} ${token?.access_token}`;\r\n    const getToken = async () => {\r\n        if (isTokenValid()) {\r\n            return getAccessToken();\r\n        }\r\n        const res = await api.token({\r\n            token: createAndSignJWT(),\r\n            apiAddress,\r\n        });\r\n        token = res.data;\r\n        tokenReceivedDate = Date.now();\r\n        return getAccessToken();\r\n    };\r\n    return {\r\n        create: async ({ headers } = {}) => api.create({\r\n            accessToken: await getToken(),\r\n            apiAddress,\r\n            ...(headers && { headers }),\r\n        }),\r\n        participants: async ({ meetingId, headers, }) => api.participants({\r\n            meetingId,\r\n            accessToken: await getToken(),\r\n            apiAddress,\r\n            ...(headers && { headers }),\r\n        }),\r\n    };\r\n};\r\n", "export var RecoveryTimeout;\r\n(function (RecoveryTimeout) {\r\n    RecoveryTimeout[RecoveryTimeout[\"ConnectionState\"] = 5000] = \"ConnectionState\";\r\n    RecoveryTimeout[RecoveryTimeout[\"IceConnectionState\"] = 2000] = \"IceConnectionState\";\r\n    RecoveryTimeout[RecoveryTimeout[\"Negotiation\"] = 200] = \"Negotiation\";\r\n})(RecoveryTimeout || (RecoveryTimeout = {}));\r\n", "export var LogLevels;\r\n(function (LogLevels) {\r\n    LogLevels[LogLevels[\"trace\"] = 10] = \"trace\";\r\n    LogLevels[LogLevels[\"debug\"] = 20] = \"debug\";\r\n    LogLevels[LogLevels[\"info\"] = 30] = \"info\";\r\n    LogLevels[LogLevels[\"warn\"] = 40] = \"warn\";\r\n    LogLevels[LogLevels[\"error\"] = 50] = \"error\";\r\n    LogLevels[LogLevels[\"fatal\"] = 60] = \"fatal\";\r\n    // eslint-disable-next-line @typescript-eslint/prefer-literal-enum-member -- needs infinity\r\n    LogLevels[LogLevels[\"silent\"] = Number.MAX_SAFE_INTEGER] = \"silent\";\r\n})(LogLevels || (LogLevels = {}));\r\n/**\r\n * Create a logger with console API, and map fatal to error, skipping trace\r\n * and silent, and there is no redaction\r\n */\r\nexport function createConsoleLogger() {\r\n    return Object.freeze({\r\n        /* eslint-disable no-console -- set logger to console */\r\n        fatal: (meta, message) => console.error(message, meta),\r\n        error: (meta, message) => console.error(message, meta),\r\n        warn: (meta, message) => console.warn(message, meta),\r\n        info: (meta, message) => console.info(message, meta),\r\n        debug: (meta, message) => console.debug(message, meta),\r\n        trace() { }, // Noop\r\n        silent() { }, // Noop\r\n        redact() { }, // Noop\r\n        /* eslint-enable no-console -- set logger to console */\r\n    });\r\n}\r\n", "import { createConsoleLogger } from './baseLogger';\r\nexport let logger = createConsoleLogger();\r\nexport function setLogger(newLogger) {\r\n    logger = newLogger;\r\n}\r\n", "/**\r\n * The type to describe the media type of the Transceiver\r\n */\r\nexport const TRANSCEIVER_MEDIA_TYPES = ['audio', 'video'];\r\nexport const CAN_SET_STREAMS = typeof RTCRtpSender !== 'undefined' &&\r\n    'setStreams' in RTCRtpSender.prototype;\r\n", "import { createSignal } from '@pexip/signal';\r\nimport { logger } from './logger';\r\nimport { CAN_SET_STREAMS } from './constants';\r\n/**\r\n * create a logger with reference attached\r\n *\r\n * @param getRefs - A function to the references for logging\r\n */\r\nexport const createRefsLog = (getRefs) => {\r\n    const info = (obj) => {\r\n        const refs = getRefs();\r\n        return { ...refs, ...obj };\r\n    };\r\n    return {\r\n        debug: (msg, obj) => logger.debug(info(obj), msg),\r\n        info: (msg, obj) => logger.info(info(obj), msg),\r\n        error: (msg, obj) => logger.error(info(obj), msg),\r\n        warn: (msg, obj) => logger.warn(info(obj), msg),\r\n    };\r\n};\r\n/**\r\n * Get the states from RTCPeerConnection\r\n *\r\n * @param pc - the peer connection to get the states\r\n */\r\nexport const getPeerConnectionStates = (pc) => ({\r\n    get connectionState() {\r\n        return pc.connectionState;\r\n    },\r\n    get iceConnectionState() {\r\n        return pc.iceConnectionState;\r\n    },\r\n    get iceGatheringState() {\r\n        return pc.iceGatheringState;\r\n    },\r\n    get signalingState() {\r\n        return pc.signalingState;\r\n    },\r\n});\r\n/**\r\n * Get common states and props from PeerConnection\r\n *\r\n * @param pc - The peer connection to get the info\r\n */\r\nexport const getStatesAndProps = (pc) => {\r\n    return {\r\n        ...getPeerConnectionStates(pc),\r\n        offerOptions: pc.offerOptions,\r\n        answerOptions: pc.answerOptions,\r\n    };\r\n};\r\nexport const logReferences = (refs) => ({\r\n    module: refs.module,\r\n    references: refs,\r\n});\r\nexport const createGetRefs = (pc) => () => ({\r\n    ...logReferences(pc.references),\r\n    ...getStatesAndProps(pc),\r\n});\r\n/**\r\n * Compare the provided 2 streams to check if they are the same\r\n * @param stream1 - the stream to compare\r\n * @param stream2 - the stream to compare\r\n */\r\nexport const isSameStream = (stream1, stream2) => {\r\n    return stream1 && stream2 && stream1.id === stream2.id;\r\n};\r\n/**\r\n * JSONify RTCPeerConnectionIceErrorEvent so more info can be captured by logger\r\n */\r\nconst jsonifyIceErrorEvent = (event) => {\r\n    // Firefox does not support RTCPeerConnectionIceErrorEvent\r\n    // https://bugzil.la/1561441\r\n    if ('RTCPeerConnectionIceErrorEvent' in window &&\r\n        event instanceof RTCPeerConnectionIceErrorEvent) {\r\n        return Object.defineProperty(event, 'toJSON', {\r\n            configurable: true,\r\n            enumerable: true,\r\n            writable: true,\r\n            value: () => ({\r\n                address: event.address,\r\n                url: event.url,\r\n                port: event.port,\r\n                errorCode: event.errorCode,\r\n                errorText: event.errorText,\r\n            }),\r\n        });\r\n    }\r\n    return event;\r\n};\r\n/**\r\n * Wire the peer connection event with the pre-defined handler and signal\r\n * accordingly\r\n *\r\n * @param wireOptions - Wire event params\r\n * + `key` - event key\r\n * + `pc` - peer connection\r\n * + `signal` - the signal to wire\r\n */\r\nexport const wirePeerConnectionEventHandler = ({ key, pc, signal, }) => {\r\n    const log = createRefsLog(createGetRefs(pc));\r\n    switch (key) {\r\n        case 'onConnectionStateChange':\r\n            pc.onConnectionStateChange = (event) => {\r\n                log.info('onConnectionStateChange emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(pc.connectionState);\r\n            };\r\n            break;\r\n        case 'onDataChannel':\r\n            pc.onDataChannel = (event) => {\r\n                log.info('onDataChannel emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(event.channel);\r\n            };\r\n            break;\r\n        case 'onIceCandidate':\r\n            pc.onIceCandidate = (event) => {\r\n                log.info('onIceCandidate emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(event.candidate);\r\n            };\r\n            break;\r\n        case 'onIceCandidateError':\r\n            pc.onIceCandidateError = (event) => {\r\n                log.info('onIceCandidateError emitted', {\r\n                    event: jsonifyIceErrorEvent(event),\r\n                });\r\n                signal.emit(event);\r\n            };\r\n            break;\r\n        case 'onIceConnectionStateChange':\r\n            pc.onIceConnectionStateChange = (event) => {\r\n                log.info('onIceConnectionStateChange emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(pc.iceConnectionState);\r\n            };\r\n            break;\r\n        case 'onIceGatheringStateChange':\r\n            pc.onIceGatheringStateChange = (event) => {\r\n                log.info('onIceGatheringStateChange emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(pc.iceGatheringState);\r\n            };\r\n            break;\r\n        case 'onNegotiationNeeded':\r\n            pc.onNegotiationNeeded = () => {\r\n                log.info('onNegotiationNeeded emitted');\r\n                signal.emit();\r\n            };\r\n            break;\r\n        case 'onSignalingStateChange':\r\n            pc.onSignalingStateChange = (event) => {\r\n                log.info('onSignalingStateChange emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(pc.signalingState);\r\n            };\r\n            break;\r\n        case 'onTrack':\r\n            pc.onTrack = (event) => {\r\n                log.info('onTrack emitted', {\r\n                    event,\r\n                });\r\n                signal.emit(event);\r\n            };\r\n            break;\r\n        case 'onRemoteStreams':\r\n            pc.onRemoteStreams = (config) => {\r\n                log.info('onRemoteStreams emitted', {\r\n                    config,\r\n                });\r\n                signal.emit(config);\r\n            };\r\n            break;\r\n        case 'onTransceiverChange':\r\n            pc.onTransceiverChange = () => {\r\n                log.info('onTransceiverChanged');\r\n                signal.emit();\r\n            };\r\n            break;\r\n        case 'onSecureCheckCode':\r\n            pc.onSecureCheckCode = (secureCheckCode) => {\r\n                log.info('onSecureCheckCode emitted', { secureCheckCode });\r\n                signal.emit(secureCheckCode);\r\n            };\r\n            break;\r\n    }\r\n};\r\n/**\r\n * Wire the peer connection events with provided signals\r\n *\r\n * @param pc - peer connection\r\n * @param signals - the set of signals to wire\r\n */\r\nexport const wirePeerConnectionEvents = (pc, signals) => {\r\n    Object.keys(signals).forEach(eventKey => {\r\n        const signalKey = eventKey;\r\n        const signal = signals[signalKey];\r\n        if (signal) {\r\n            wirePeerConnectionEventHandler({\r\n                key: signalKey,\r\n                pc,\r\n                signal,\r\n            });\r\n        }\r\n    });\r\n};\r\n/**\r\n * Create a general signal with consistent scoped name\r\n *\r\n * @param name - Signal name\r\n * @param crucial - Signify if the signal is unmissable.\r\n */\r\nexport const createPCSignal = (name, crucial = true) => createSignal({\r\n    name: `call:peerConnection:${name}`,\r\n    allowEmittingWithoutObserver: !crucial,\r\n});\r\nexport const REQUIRED_SIGNAL_KEYS = [\r\n    'onOfferRequired',\r\n    'onReceiveAnswer',\r\n    'onReceiveOffer',\r\n    'onOffer',\r\n    'onOfferIgnored',\r\n    'onAnswer',\r\n    'onError',\r\n];\r\n/**\r\n * Create and return all required and optional (if specified with `more`),\r\n * signals for peer connection to work\r\n *\r\n * @param more - Keys from `PCOptionalsSignals`, @see PCOptionalsSignals\r\n * @param scope - any scope prefix for the generated signal name, @see Signal\r\n *\r\n * The following signals created by default\r\n *  'onOfferRequired',\r\n *  'onReceiveAnswer',\r\n *  'onReceiveOffer',\r\n *  'onOffer',\r\n *  'onAnswer',\r\n *  'onError',\r\n * @see REQUIRED_SIGNAL_KEYS\r\n */\r\nexport const createPCSignals = (more, scope = '') => {\r\n    const signalScope = scope && [scope, ':'].join('');\r\n    return [...REQUIRED_SIGNAL_KEYS, ...more].reduce((signals, key) => ({\r\n        ...signals,\r\n        [key]: createPCSignal(`${signalScope}${key}`),\r\n    }), {});\r\n};\r\n/**\r\n * Handle some core signals for the peer connection.\r\n *\r\n * @param peer - The peer connection\r\n *\r\n * @returns the signal subscriptions which are needed to be called when closing\r\n * the peer connection\r\n */\r\nexport const withSignals = (peer) => \r\n/**\r\n * Map signals\r\n *\r\n * @param signals - The provided signals to map to the PC events\r\n */\r\n({ onReceiveAnswer, onReceiveIceCandidate, onReceiveOffer, onOffer, onOfferIgnored, onAnswer, onError, onNegotiationNeeded = createPCSignal('onNegotiationNeeded'), onIceCandidateError = createPCSignal('onIceCandidateError'), ...pcEventSignals }) => {\r\n    // Wire PeerConnection events to signals\r\n    pcEventSignals &&\r\n        wirePeerConnectionEvents(peer, {\r\n            ...pcEventSignals,\r\n            onNegotiationNeeded,\r\n            onIceCandidateError,\r\n        });\r\n    // States for Perfect Negotiation\r\n    const props = {\r\n        receivingFirstOffer: true,\r\n        makingOffer: false,\r\n        ignoreOffer: false,\r\n    };\r\n    const log = createRefsLog(() => ({\r\n        ...createGetRefs(peer)(),\r\n        ...props,\r\n    }));\r\n    /**\r\n     * Log and emit Error\r\n     */\r\n    const emitError = (msg, context) => {\r\n        log.error(msg, { ...context, ...getPeerConnectionStates(peer) });\r\n        if (context?.error instanceof Error) {\r\n            onError.emit(context.error);\r\n        }\r\n    };\r\n    const emitLocalDescription = (sdp) => {\r\n        const localDescription = sdp ?? peer.pendingLocalDescription;\r\n        switch (localDescription?.type) {\r\n            case 'offer':\r\n                onOffer.emit(localDescription);\r\n                break;\r\n            case 'answer':\r\n                onAnswer.emit(localDescription);\r\n                break;\r\n            default:\r\n                log.error('Attempt to emit localDescription other than \"answer\" and \"offer\"', { localDescription });\r\n                throw new Error('Unknown SDP type');\r\n        }\r\n        peer.releaseLocalICECandidatesBuffer(false);\r\n    };\r\n    const signalSubscriptions = [\r\n        onNegotiationNeeded.add(async () => {\r\n            log.info('handle onNegotiationNeeded signal');\r\n            try {\r\n                props.makingOffer = true;\r\n                const offer = await peer.createOffer();\r\n                log.info('emit offer', { offer });\r\n                emitLocalDescription(offer);\r\n            }\r\n            catch (error) {\r\n                if (error instanceof Error) {\r\n                    if (error.message !== 'Ignore') {\r\n                        emitError('createOffer', { error });\r\n                    }\r\n                }\r\n            }\r\n            finally {\r\n                props.makingOffer = false;\r\n            }\r\n        }),\r\n        onIceCandidateError.add(error => {\r\n            // Sometimes the IceCandidateError could be just a noise, let's just log it instead\r\n            emitError('onIceCandidateError', {\r\n                event: error,\r\n            });\r\n        }),\r\n        onReceiveIceCandidate?.add(async (candidate) => {\r\n            log.info('handle onReceiveIceCandidate signal', { candidate });\r\n            try {\r\n                await peer.receiveIceCandidate(candidate);\r\n            }\r\n            catch (error) {\r\n                // Ignore receiving ICE error since we ignore the\r\n                // offer/answer as a polite peer, otherwise forward the error\r\n                if (!props.ignoreOffer) {\r\n                    emitError('receiveIceCandidate', { error, candidate });\r\n                }\r\n            }\r\n        }),\r\n        onReceiveOffer.add(async (offer) => {\r\n            try {\r\n                const offerCollisionDetected = props.makingOffer || peer.signalingState !== 'stable';\r\n                props.ignoreOffer = !peer.polite && offerCollisionDetected;\r\n                log.info('handle receiveOffer signal', {\r\n                    politePeer: peer.polite,\r\n                    offer,\r\n                    offerCollisionDetected,\r\n                    ignoreOffer: props.ignoreOffer,\r\n                });\r\n                if (props.ignoreOffer) {\r\n                    log.info('ignore offer', {\r\n                        politePeer: peer.polite,\r\n                        offer,\r\n                        offerCollisionDetected,\r\n                        ignoreOffer: props.ignoreOffer,\r\n                    });\r\n                    onOfferIgnored.emit();\r\n                    return;\r\n                }\r\n                peer.releaseLocalICECandidatesBuffer(true);\r\n                await peer.receiveOffer(offer);\r\n                const answer = await peer.createAnswer();\r\n                log.info('emit answer', { answer });\r\n                emitLocalDescription(answer);\r\n            }\r\n            catch (error) {\r\n                emitError('receiveOffer/createAnswer', { error, offer });\r\n            }\r\n            finally {\r\n                props.receivingFirstOffer = false;\r\n            }\r\n        }),\r\n        onReceiveAnswer.add(async (answer) => {\r\n            log.info('handle receiveAnswer signal', { answer });\r\n            props.receivingFirstOffer = false;\r\n            try {\r\n                await peer.receiveAnswer(answer);\r\n            }\r\n            catch (error) {\r\n                emitError('receiveAnswer', { error, answer });\r\n            }\r\n        }),\r\n    ].flatMap(a => (a ? [a] : []));\r\n    return signalSubscriptions;\r\n};\r\n/**\r\n *  workaround to allow echo cancellation in Chromium browsers, due to https://bugs.chromium.org/p/chromium/issues/detail?id=687574.\r\n *\r\n * based on https://dev.to/focusedlabs/echo-cancellation-with-web-audio-api-and-chromium-1f8m\r\n *  and https://gist.github.com/alexciarlillo/4b9f75516f93c10d7b39282d10cd17bc\r\n */\r\nexport const getCreateLoopbackConnectionFn = (rtcConnection = new RTCPeerConnection(), rtcLoopbackConnection = new RTCPeerConnection(), loopbackStream = new MediaStream()) => async (stream) => {\r\n    rtcConnection.onicecandidate = e => e.candidate &&\r\n        rtcLoopbackConnection.addIceCandidate(new RTCIceCandidate(e.candidate));\r\n    rtcLoopbackConnection.onicecandidate = e => e.candidate &&\r\n        rtcConnection.addIceCandidate(new RTCIceCandidate(e.candidate));\r\n    rtcLoopbackConnection.ontrack = e => {\r\n        if (e.streams[0]) {\r\n            return e.streams[0]\r\n                .getTracks()\r\n                .forEach(track => loopbackStream.addTrack(track));\r\n        }\r\n    };\r\n    stream.getTracks().forEach(function (track) {\r\n        rtcConnection.addTrack(track, stream);\r\n    });\r\n    const offer = await rtcConnection.createOffer();\r\n    await rtcConnection.setLocalDescription(offer);\r\n    await rtcLoopbackConnection.setRemoteDescription(offer);\r\n    const answer = await rtcLoopbackConnection.createAnswer();\r\n    await rtcLoopbackConnection.setLocalDescription(answer);\r\n    await rtcConnection.setRemoteDescription(answer);\r\n    return loopbackStream;\r\n};\r\nexport const isTransceiverMediaType = (mediaType) => mediaType === 'audio' || mediaType === 'video';\r\nexport const isMediaType = (t) => {\r\n    if (isTransceiverMediaType(t) || t === 'application') {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nexport const assertTransceiverMediaType = (mediaType) => {\r\n    if (!isTransceiverMediaType(mediaType)) {\r\n        throw new Error(`Expected a media kind string, \"audio\" | \"video\" but got \"${mediaType}\"`);\r\n    }\r\n    return mediaType;\r\n};\r\nexport const resolveKindOrTrack = (kindOrTrack) => {\r\n    if (!('MediaStreamTrack' in window) ||\r\n        !(kindOrTrack instanceof MediaStreamTrack)) {\r\n        return {\r\n            kind: assertTransceiverMediaType(kindOrTrack),\r\n            track: undefined,\r\n        };\r\n    }\r\n    return {\r\n        track: kindOrTrack,\r\n        kind: assertTransceiverMediaType(kindOrTrack.kind),\r\n    };\r\n};\r\nconst isMediaStream = (t) => {\r\n    if (typeof t === 'object' && t !== null && t instanceof MediaStream) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nconst isMediaStreams = (t) => Array.isArray(t) && t.every(isMediaStream);\r\nconst isDataChannelObsolete = (dataChannel) => dataChannel.readyState === 'closing' || dataChannel.readyState === 'closed';\r\nconst createDataChannelConfig = (init) => {\r\n    const props = {\r\n        ...init,\r\n    };\r\n    const subscribeEvents = (dc) => {\r\n        init.eventListeners?.forEach(({ event, listener, options }) => {\r\n            // To make tsc happy\r\n            switch (event) {\r\n                case 'message':\r\n                    dc.addEventListener(event, listener, options);\r\n                    break;\r\n                default:\r\n                    dc.addEventListener(event, listener, options);\r\n                    break;\r\n            }\r\n        });\r\n        dc.addEventListener('close', () => {\r\n            init.eventListeners?.forEach(({ event, listener, options }) => {\r\n                // To make tsc happy\r\n                switch (event) {\r\n                    case 'message':\r\n                        dc.removeEventListener(event, listener, options);\r\n                        break;\r\n                    default:\r\n                        dc.removeEventListener(event, listener, options);\r\n                        break;\r\n                }\r\n            });\r\n        }, { once: true });\r\n    };\r\n    const isDirty = () => !props.dataChannel || isDataChannelObsolete(props.dataChannel);\r\n    return {\r\n        get dirty() {\r\n            return isDirty();\r\n        },\r\n        get options() {\r\n            return init;\r\n        },\r\n        get kind() {\r\n            return 'application';\r\n        },\r\n        get dataChannel() {\r\n            return props.dataChannel;\r\n        },\r\n        set dataChannel(dc) {\r\n            if (dc) {\r\n                subscribeEvents(dc);\r\n            }\r\n            props.dataChannel = dc;\r\n        },\r\n        syncDataChannel: peer => {\r\n            if (!isDirty()) {\r\n                return;\r\n            }\r\n            logger.debug({ init, props }, 'syncDataChannel');\r\n            const dc = peer.createDataChannel(init.label, init);\r\n            props.dataChannel = dc;\r\n            subscribeEvents(dc);\r\n        },\r\n        toString() {\r\n            return [\r\n                this.options.label,\r\n                `DataChannel${this.options.id !== undefined ? `(${this.options.id})` : ''}`,\r\n            ].join('-');\r\n        },\r\n    };\r\n};\r\nexport const isTransceiverObsolete = (transceiver) => {\r\n    return transceiver.mid === null && transceiver.currentDirection !== null;\r\n};\r\n/**\r\n * Compare 2 flat records (an object with primitive type) using Object.is comparator\r\n *\r\n * @remarks No deep comparison\r\n */\r\nexport const compareRecord = (record1, record2) => {\r\n    if (record1 === record2) {\r\n        return true;\r\n    }\r\n    if (!record1 || !record2) {\r\n        return false;\r\n    }\r\n    const keys = new Set([...Object.keys(record1), ...Object.keys(record2)]);\r\n    for (const key of keys) {\r\n        if (record1[key] !== record2[key]) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/**\r\n * Compare 2 Array and using the provided predicate to compare\r\n */\r\nexport const compareArray = (list1, list2, predicate) => {\r\n    if ((list1 === undefined && list2 !== undefined) ||\r\n        (list1 !== undefined && list2 === undefined)) {\r\n        return false;\r\n    }\r\n    const len = Math.max(list1?.length ?? 0, list2?.length ?? 0);\r\n    for (let i = 0; i < len; i++) {\r\n        const a = list1?.[i];\r\n        const b = list2?.[i];\r\n        if (!predicate(a, b)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/**\r\n * Merge two array and overwriting the old on with the new one in order\r\n */\r\nexport const merge = (oldParam, newParam) => {\r\n    const len = Math.max(oldParam.length, newParam.length);\r\n    const merged = [];\r\n    for (let i = 0; i < len; i++) {\r\n        const o = oldParam[i];\r\n        const n = newParam[i];\r\n        if (!n) {\r\n            return merged;\r\n        }\r\n        merged.push({ ...o, ...n });\r\n    }\r\n    return merged;\r\n};\r\nconst createTransceiverConfig = ({ kindOrTrack, content, direction, streams, sendEncodings, transceiver, allowAutoChangeOfDirection = true, relativeDirection = true, }, onTransceiverChanged) => {\r\n    const { track, kind } = resolveKindOrTrack(kindOrTrack);\r\n    const props = {\r\n        content: content ?? 'main',\r\n        track,\r\n        kind,\r\n        streams: streams ?? [],\r\n        direction: direction ?? 'sendrecv',\r\n        transceiver,\r\n        allowAutoChangeOfDirection,\r\n        relativeDirection,\r\n        sendEncodings,\r\n    };\r\n    const dirty = {\r\n        track: transceiver ? false : Boolean(track),\r\n        streams: transceiver ? false : Boolean(streams?.length),\r\n        sendParameters: transceiver ? false : Boolean(sendEncodings),\r\n        direction: allowAutoChangeOfDirection,\r\n        get dirty() {\r\n            return (this.track ||\r\n                this.streams ||\r\n                this.direction ||\r\n                this.sendParameters);\r\n        },\r\n    };\r\n    const proxy = new Proxy(props, {\r\n        // eslint-disable-next-line max-params --- from lib.dom.d\r\n        set(target, p, newValue, receiver) {\r\n            switch (p) {\r\n                case 'track': {\r\n                    if (newValue !== undefined && target[p] !== newValue) {\r\n                        Reflect.set(target, p, newValue, receiver);\r\n                        dirty[p] = true;\r\n                    }\r\n                    return true;\r\n                }\r\n                case 'streams': {\r\n                    if (newValue !== undefined && isMediaStreams(newValue)) {\r\n                        const setOld = new Set(target[p].map(s => s.id));\r\n                        const setNew = new Set(newValue.map(s => s.id));\r\n                        for (const old of setOld) {\r\n                            if (setNew.has(old)) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                        target[p] = newValue;\r\n                        dirty[p] = true;\r\n                    }\r\n                    return true;\r\n                }\r\n                case 'direction': {\r\n                    const newDirection = deriveSendDirectionFromTrack(newValue, props.transceiver?.sender.track ?? props.track);\r\n                    if (target[p] !== newDirection) {\r\n                        Reflect.set(target, p, newDirection, receiver);\r\n                        dirty[p] = true;\r\n                    }\r\n                    return true;\r\n                }\r\n                case 'transceiver': {\r\n                    if (newValue !== undefined &&\r\n                        newValue instanceof RTCRtpTransceiver &&\r\n                        target[p] !== newValue) {\r\n                        target[p]?.stop();\r\n                        if (target.track) {\r\n                            dirty.track = true;\r\n                        }\r\n                        if (target.streams.length) {\r\n                            dirty.streams = true;\r\n                        }\r\n                        if (target.direction !== newValue.direction) {\r\n                            dirty.direction = true;\r\n                        }\r\n                        Reflect.set(target, p, newValue, receiver);\r\n                        onTransceiverChanged(newValue, config);\r\n                    }\r\n                    return true;\r\n                }\r\n                case 'sendEncodings': {\r\n                    if (newValue !== undefined &&\r\n                        !compareArray(target[p], newValue, compareRecord)) {\r\n                        Reflect.set(target, p, newValue, receiver);\r\n                        dirty.sendParameters = true;\r\n                    }\r\n                    return true;\r\n                }\r\n                default: {\r\n                    Reflect.set(target, p, newValue, receiver);\r\n                    return true;\r\n                }\r\n            }\r\n        },\r\n    });\r\n    const syncStreams = () => {\r\n        if (!CAN_SET_STREAMS ||\r\n            !dirty.streams ||\r\n            !props.track ||\r\n            !props.transceiver ||\r\n            isTransceiverObsolete(props.transceiver)) {\r\n            return;\r\n        }\r\n        dirty.streams = false;\r\n        logger.debug({ config, props, dirty }, 'syncStreams');\r\n        props.transceiver.sender.setStreams(...props.streams);\r\n    };\r\n    const syncDirection = () => {\r\n        if (!props.allowAutoChangeOfDirection ||\r\n            !dirty.direction ||\r\n            !props.transceiver ||\r\n            isTransceiverObsolete(props.transceiver)) {\r\n            return;\r\n        }\r\n        if (props.transceiver.direction === props.direction) {\r\n            return;\r\n        }\r\n        dirty.direction = false;\r\n        logger.debug({ config, props, dirty }, 'syncDirection');\r\n        props.transceiver.direction = props.direction;\r\n    };\r\n    const syncSenderTrack = async () => {\r\n        if (!props.transceiver ||\r\n            isTransceiverObsolete(props.transceiver) ||\r\n            !dirty.track ||\r\n            props.track === undefined ||\r\n            props.track === props.transceiver?.sender.track) {\r\n            return;\r\n        }\r\n        dirty.track = false;\r\n        logger.debug({ config, props, dirty }, 'syncSenderTrack');\r\n        await props.transceiver.sender.replaceTrack(props.track);\r\n        syncStreams();\r\n    };\r\n    const syncSenderParameters = async () => {\r\n        const encodings = props.sendEncodings;\r\n        const params = props.transceiver?.sender.getParameters();\r\n        // https://developer.mozilla.org/en-US/docs/Web/API/RTCRtpSender/setParameters#currently_compatible_implementation\r\n        if (params && !params.encodings) {\r\n            params.encodings = [{}];\r\n        }\r\n        if (!props.transceiver ||\r\n            isTransceiverObsolete(props.transceiver) ||\r\n            !dirty.sendParameters ||\r\n            encodings === undefined ||\r\n            params === undefined ||\r\n            params.encodings.every((param, idx) => compareRecord(param, encodings[idx]))) {\r\n            return;\r\n        }\r\n        dirty.sendParameters = false;\r\n        logger.debug({ config, props, dirty }, 'syncSenderTrack');\r\n        await props.transceiver.sender.setParameters({\r\n            ...params,\r\n            encodings: merge(params.encodings, encodings),\r\n        });\r\n    };\r\n    const isDirty = () => dirty.dirty ||\r\n        !props.transceiver ||\r\n        isTransceiverObsolete(props.transceiver);\r\n    const config = {\r\n        get content() {\r\n            return props.content;\r\n        },\r\n        get dirty() {\r\n            return isDirty();\r\n        },\r\n        get kind() {\r\n            return props.kind;\r\n        },\r\n        get allowAutoChangeOfDirection() {\r\n            return props.allowAutoChangeOfDirection;\r\n        },\r\n        set allowAutoChangeOfDirection(allowed) {\r\n            props.allowAutoChangeOfDirection = allowed;\r\n        },\r\n        get relativeDirection() {\r\n            return props.relativeDirection;\r\n        },\r\n        set relativeDirection(relative) {\r\n            props.relativeDirection = relative;\r\n        },\r\n        get direction() {\r\n            return props.direction;\r\n        },\r\n        set direction(direction) {\r\n            proxy.direction = direction;\r\n        },\r\n        get sendEncodings() {\r\n            return props.sendEncodings;\r\n        },\r\n        set sendEncodings(encodings) {\r\n            proxy.sendEncodings = encodings;\r\n        },\r\n        get streams() {\r\n            return props.streams;\r\n        },\r\n        set streams(streams) {\r\n            proxy.streams = streams;\r\n        },\r\n        get remoteStreams() {\r\n            return props.remoteStreams;\r\n        },\r\n        set remoteStreams(streams) {\r\n            props.remoteStreams = streams;\r\n        },\r\n        get transceiver() {\r\n            return props.transceiver;\r\n        },\r\n        set transceiver(transceiver) {\r\n            proxy.transceiver = transceiver;\r\n        },\r\n        get track() {\r\n            return props.track;\r\n        },\r\n        set track(track) {\r\n            proxy.track = track;\r\n        },\r\n        syncStreams,\r\n        syncDirection,\r\n        syncSenderTrack,\r\n        syncSenderParameters,\r\n        syncTransceiver: async (peer, option = {}) => {\r\n            if (option.track !== undefined) {\r\n                proxy.track = option.track;\r\n            }\r\n            if (option.streams) {\r\n                proxy.streams = option.streams;\r\n            }\r\n            if (option.direction) {\r\n                proxy.direction = option.direction;\r\n            }\r\n            if (option.sendEncodings) {\r\n                proxy.sendEncodings = option.sendEncodings;\r\n            }\r\n            if (!isDirty()) {\r\n                return;\r\n            }\r\n            if (props.transceiver &&\r\n                !isTransceiverObsolete(props.transceiver)) {\r\n                await syncSenderTrack();\r\n                syncDirection();\r\n                await syncSenderParameters();\r\n            }\r\n            else {\r\n                logger.debug({ config, props, dirty }, 'addTransceiver');\r\n                dirty.track = false;\r\n                dirty.streams = false;\r\n                dirty.direction = false;\r\n                proxy.transceiver = peer.addTransceiver(props.track ?? props.kind, {\r\n                    direction: props.direction,\r\n                    streams: props.streams,\r\n                    sendEncodings: props.sendEncodings,\r\n                });\r\n            }\r\n        },\r\n        toString() {\r\n            return [this.content, this.kind, this.transceiver?.mid]\r\n                .filter(Boolean)\r\n                .join('-');\r\n        },\r\n    };\r\n    return config;\r\n};\r\nexport const isTransceiverInit = (t) => {\r\n    if (typeof t === 'object' && t && 'kindOrTrack' in t) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nexport const isTransceiverConfig = (t) => {\r\n    if (typeof t === 'object' &&\r\n        t &&\r\n        'kind' in t &&\r\n        typeof t.kind === 'string' &&\r\n        ['audio', 'video'].includes(t.kind)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nexport const isDataChannelInit = (t) => {\r\n    if (typeof t === 'object' &&\r\n        t &&\r\n        'label' in t &&\r\n        typeof t.label === 'string') {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nexport const isDataChannelConfig = (t) => {\r\n    if (typeof t === 'object' &&\r\n        t &&\r\n        'kind' in t &&\r\n        typeof t.kind === 'string' &&\r\n        t.kind === 'application') {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nexport const isMediaInit = (t) => isTransceiverInit(t) || isDataChannelInit(t);\r\nexport const isMediaConfig = (t) => isTransceiverConfig(t) || isDataChannelConfig(t);\r\nexport const createMediaConfigs = (mediaInits, onTransceiverChanged) => {\r\n    const map = new Map();\r\n    const handleTransceiverChanged = (trans, config) => {\r\n        map.set(trans, config);\r\n        logger.debug({ map, transceiver: trans, config }, 'handleTransceiverChanged');\r\n        onTransceiverChanged?.();\r\n    };\r\n    const mediaConfigs = mediaInits?.map(init => {\r\n        if (isTransceiverInit(init)) {\r\n            const config = createTransceiverConfig(init, handleTransceiverChanged);\r\n            return config;\r\n        }\r\n        return createDataChannelConfig(init);\r\n    }) ?? [];\r\n    function getConfig(key) {\r\n        return map.get(key);\r\n    }\r\n    function addConfig(peer, initOrConfig) {\r\n        if (isTransceiverInit(initOrConfig)) {\r\n            const trackOrKind = initOrConfig.kindOrTrack;\r\n            const transceiver = initOrConfig.transceiver\r\n                ? initOrConfig.transceiver\r\n                : peer.addTransceiver(trackOrKind, initOrConfig);\r\n            const config = createTransceiverConfig({ ...initOrConfig, transceiver }, handleTransceiverChanged);\r\n            mediaConfigs.push(config);\r\n            handleTransceiverChanged(transceiver, config);\r\n            return config;\r\n        }\r\n        if (isTransceiverConfig(initOrConfig)) {\r\n            const trackOrKind = initOrConfig.track ?? initOrConfig.kind;\r\n            const transceiver = initOrConfig.transceiver ??\r\n                peer.addTransceiver(trackOrKind, initOrConfig);\r\n            mediaConfigs.push(initOrConfig);\r\n            handleTransceiverChanged(transceiver, initOrConfig);\r\n            return initOrConfig;\r\n        }\r\n        if (isDataChannelInit(initOrConfig)) {\r\n            const dataChannel = initOrConfig.dataChannel ??\r\n                peer.createDataChannel(initOrConfig.label, initOrConfig);\r\n            const config = createDataChannelConfig({\r\n                ...initOrConfig,\r\n                dataChannel,\r\n            });\r\n            mediaConfigs.push(config);\r\n            return config;\r\n        }\r\n        if (!initOrConfig.dataChannel) {\r\n            peer.createDataChannel(initOrConfig.options.label, initOrConfig.options);\r\n        }\r\n        mediaConfigs.push(initOrConfig);\r\n        return initOrConfig;\r\n    }\r\n    return {\r\n        get configs() {\r\n            return mediaConfigs;\r\n        },\r\n        addConfig,\r\n        getConfig,\r\n        find: (predicate) => mediaConfigs.find(predicate),\r\n    };\r\n};\r\n/**\r\n * Try to derive the direction from `currentDirection` and the `intendedDirection`\r\n */\r\nexport const changeTransceiverDirection = (currentDirection, intendedDirection = 'send') => {\r\n    if (intendedDirection !== 'send' && intendedDirection !== 'recv') {\r\n        return intendedDirection;\r\n    }\r\n    switch (currentDirection) {\r\n        case 'inactive': {\r\n            return intendedDirection === 'send' ? 'sendonly' : 'recvonly';\r\n        }\r\n        case 'recvonly': {\r\n            return intendedDirection === 'send' ? 'sendrecv' : 'recvonly';\r\n        }\r\n        case 'sendonly': {\r\n            return intendedDirection === 'send' ? 'sendonly' : 'sendrecv';\r\n        }\r\n        case 'sendrecv':\r\n        default:\r\n            return 'sendrecv';\r\n    }\r\n};\r\n/**\r\n * Get the relative direction so you can get the correct direction, e.g.\r\n * `\"sendonly\" <--> \"recvonly\"`\r\n *\r\n * From https://www.rfc-editor.org/rfc/rfc3264.html#section-6.1\r\n * \\> If a stream is offered as sendonly, the corresponding stream MUST be\r\n * \\> marked as recvonly or inactive in the answer.  If a media stream is\r\n * \\> listed as recvonly in the offer, the answer MUST be marked as\r\n * \\> sendonly or inactive in the answer.  If an offered media stream is\r\n * \\> listed as sendrecv (or if there is no direction attribute at the\r\n * \\> media or session level, in which case the stream is sendrecv by\r\n * \\> default), the corresponding stream in the answer MAY be marked as\r\n * \\> sendonly, recvonly, sendrecv, or inactive.  If an offered media\r\n * \\> stream is listed as inactive, it MUST be marked as inactive in the\r\n * \\> answer.\r\n */\r\nexport const getRelativeDirection = (remoteDirection) => {\r\n    switch (remoteDirection) {\r\n        case 'sendonly':\r\n            return 'recvonly';\r\n        case 'recvonly':\r\n            return 'sendonly';\r\n        case 'inactive':\r\n            return 'inactive';\r\n        case 'sendrecv':\r\n        default:\r\n            // if there is no direction attribute at the media or session level,\r\n            // the stream is `sendrecv` by default\r\n            return 'sendrecv';\r\n    }\r\n};\r\nexport const deriveSendDirectionFromTrack = (intendedDirection, track) => {\r\n    const hasTrack = Boolean(track);\r\n    if (hasTrack || !intendedDirection.includes('send')) {\r\n        return intendedDirection;\r\n    }\r\n    switch (intendedDirection) {\r\n        case 'sendonly':\r\n            return 'inactive';\r\n        case 'sendrecv':\r\n            return 'recvonly';\r\n        default:\r\n            return intendedDirection;\r\n    }\r\n};\r\n/**\r\n * Create a queue to handle buffering and trigger provided `callback` being\r\n * called in order.\r\n *\r\n * @param callback - The callback being called\r\n */\r\nexport const createEventQueue = (callback) => {\r\n    const queue = [];\r\n    let buffering = true;\r\n    return {\r\n        get buffering() {\r\n            return buffering;\r\n        },\r\n        set buffering(value) {\r\n            buffering = value;\r\n        },\r\n        get length() {\r\n            return queue.length;\r\n        },\r\n        get items() {\r\n            return [...queue];\r\n        },\r\n        /**\r\n         * Put an item to the end of the queue. When the attribute `buffering`\r\n         * is `false`, it triggers the `callback` immediately instead of putting\r\n         * the item into the queue.\r\n         *\r\n         * @param item - The item to put into the queue\r\n         */\r\n        enqueue: (item) => {\r\n            if (buffering) {\r\n                queue.push(item);\r\n            }\r\n            else {\r\n                for (const item of queue) {\r\n                    callback(item);\r\n                }\r\n                callback(item);\r\n            }\r\n        },\r\n        /**\r\n         * Empty the queue by running the callback with all the items in the\r\n         * queue in-order, and returns the items;\r\n         */\r\n        flush: () => queue.splice(0, queue.length).map(item => {\r\n            callback(item);\r\n            return item;\r\n        }),\r\n        /**\r\n         * Discard all the items without any side effects\r\n         */\r\n        discard: () => {\r\n            queue.length = 0;\r\n        },\r\n    };\r\n};\r\nexport const subscribePCEvents = (pc, listeners) => {\r\n    listeners.forEach(({ event, listener, options }) => {\r\n        // To make tsc happy\r\n        switch (event) {\r\n            case 'datachannel': {\r\n                pc.addEventListener(event, listener, options);\r\n                break;\r\n            }\r\n            case 'icecandidate': {\r\n                pc.addEventListener(event, listener, options);\r\n                break;\r\n            }\r\n            case 'track': {\r\n                pc.addEventListener(event, listener, options);\r\n                break;\r\n            }\r\n            default: {\r\n                pc.addEventListener(event, listener, options);\r\n                break;\r\n            }\r\n        }\r\n    });\r\n    pc.addEventListener('close', () => {\r\n        listeners.forEach(({ event, listener, options }) => {\r\n            // To make tsc happy\r\n            switch (event) {\r\n                case 'datachannel': {\r\n                    pc.removeEventListener(event, listener, options);\r\n                    break;\r\n                }\r\n                case 'icecandidate': {\r\n                    pc.removeEventListener(event, listener, options);\r\n                    break;\r\n                }\r\n                case 'track': {\r\n                    pc.removeEventListener(event, listener, options);\r\n                    break;\r\n                }\r\n                default: {\r\n                    pc.removeEventListener(event, listener, options);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n    }, { once: true });\r\n};\r\n/**\r\n * A wrapper to create a RTCPeerConnection instance and subscribe the events\r\n * declared from the provided list of `listeners`.\r\n *\r\n * @param options - The configuration for the `RTCPeerConnection`\r\n * @param listeners - A list of listeners to listen on the Peer Connection\r\n * events\r\n * @param existingPC - Instead of creating a new Peer Connection, it always uses\r\n * this instance instead.\r\n */\r\nexport const createRTCPeerConnection = (options, listeners, existingPC) => {\r\n    const pc = (existingPC ??\r\n        new RTCPeerConnection(options));\r\n    listeners && subscribePCEvents(pc, listeners);\r\n    return pc;\r\n};\r\n", "import * as sdpTransform from 'sdp-transform';\r\nvar Codec;\r\n(function (Codec) {\r\n    Codec[\"VP8\"] = \"VP8\";\r\n    Codec[\"VP9\"] = \"VP9\";\r\n    Codec[\"H264\"] = \"H264\";\r\n})(Codec || (Codec = {}));\r\n// https://tools.ietf.org/html/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\nexport const TWCCExtensionUrl = 'http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions';\r\nexport class SdpTransformManager {\r\n    constructor(sdp, enrichOptions) {\r\n        this.sdp = sdp;\r\n        this.isTWCCsupported = () => this.sdp.sdp?.includes(TWCCExtensionUrl);\r\n        this.addContentAttribute = (mid, content) => {\r\n            if (!this.sdp.sdp || !content) {\r\n                return;\r\n            }\r\n            let modifiedSdp = this.sdp;\r\n            const transformSdp = sdpTransform.parse(this.sdp.sdp);\r\n            const mline = this.getMediaLine(transformSdp.media, mid);\r\n            if (!mline) {\r\n                return;\r\n            }\r\n            this.setContentAttribute(mline, content);\r\n            modifiedSdp = {\r\n                sdp: sdpTransform.write(transformSdp),\r\n                type: this.sdp.type,\r\n            };\r\n            this.sdp = modifiedSdp;\r\n        };\r\n        this.addMsidToMline = (transceiver, msid) => {\r\n            if (!this.sdp.sdp) {\r\n                return;\r\n            }\r\n            let modifiedSdp = this.sdp;\r\n            const transformSdp = sdpTransform.parse(this.sdp.sdp);\r\n            const mLine = transformSdp.media.find(mline => {\r\n                if (transceiver.mid) {\r\n                    return (String(mline.mid) === transceiver.mid &&\r\n                        mline.type ===\r\n                            (transceiver.sender.track?.kind ??\r\n                                transceiver.receiver.track.kind));\r\n                }\r\n            });\r\n            if (!mLine) {\r\n                // No such media line\r\n                return;\r\n            }\r\n            const msids = mLine.msid?.split(' ');\r\n            // Associate the stream id to for streamless for just replace\r\n            if (msids?.[0]) {\r\n                msids[0] = msid;\r\n            }\r\n            mLine.msid = msids?.join(' ');\r\n            modifiedSdp = {\r\n                sdp: sdpTransform.write(transformSdp),\r\n                type: this.sdp.type,\r\n            };\r\n            this.sdp = modifiedSdp;\r\n        };\r\n        this.setSdp(sdp, enrichOptions);\r\n    }\r\n    setSdp(sdp, enrichOptions) {\r\n        this.sdp = sdp;\r\n        if (enrichOptions) {\r\n            this.enrichSdp(enrichOptions);\r\n        }\r\n    }\r\n    getSdp() {\r\n        return this.sdp;\r\n    }\r\n    getFingerprints() {\r\n        if (!this.sdp?.sdp) {\r\n            return [];\r\n        }\r\n        const transformSdp = sdpTransform.parse(this.sdp.sdp);\r\n        return [\r\n            transformSdp.fingerprint,\r\n            ...transformSdp.media.map(m => m.fingerprint),\r\n        ].flatMap(fingerprint => (fingerprint ? [fingerprint] : []));\r\n    }\r\n    enrichSdp(options) {\r\n        let modifiedSdp = this.sdp;\r\n        if (this.sdp?.sdp) {\r\n            let transformSdp = sdpTransform.parse(this.sdp.sdp);\r\n            if (options.contents) {\r\n                transformSdp.media\r\n                    .filter(mline => mline.type === 'audio' || mline.type === 'video')\r\n                    .forEach((mline, idx) => {\r\n                    mline.content = options.contents?.[idx];\r\n                });\r\n            }\r\n            if (options.sendEncodings) {\r\n                transformSdp.media\r\n                    .filter(mline => mline.type === 'audio' || mline.type === 'video')\r\n                    .forEach((mline, idx) => {\r\n                    const encodings = options.sendEncodings?.[idx];\r\n                    if (mline.rids && encodings) {\r\n                        mline.rids.forEach((rid, i) => {\r\n                            const { maxWidth, maxHeight } = encodings?.[i] ?? {};\r\n                            const paramArray = rid.params\r\n                                ? rid.params.split(';')\r\n                                : [];\r\n                            if (mline.type === 'video') {\r\n                                if (maxHeight &&\r\n                                    !paramArray.find(param => param.includes('max-height='))) {\r\n                                    paramArray.push(`max-height=${maxHeight}`);\r\n                                }\r\n                            }\r\n                            if (maxWidth &&\r\n                                !paramArray.find(param => param.includes('max-width='))) {\r\n                                paramArray.push(`max-width=${maxWidth}`);\r\n                            }\r\n                            if (paramArray.length > 0) {\r\n                                rid.params = paramArray.join(';');\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            if (options.videoAS) {\r\n                transformSdp = this.addBandwidthLine(transformSdp, options.videoAS, options.videoTIAS);\r\n            }\r\n            if (options.allowCodecSdpMunging && !options.allowVP9) {\r\n                transformSdp = this.stripCodecs(transformSdp, [Codec.VP9]);\r\n            }\r\n            if (this.shouldAddSupportForHighQualityStream(options)) {\r\n                transformSdp = this.addSupportForHighQualityStream(transformSdp, options.allow4kPreso);\r\n            }\r\n            if (options.allowCodecSdpMunging) {\r\n                transformSdp = this.chooseVideoPTs(transformSdp);\r\n            }\r\n            modifiedSdp = {\r\n                sdp: sdpTransform.write(transformSdp),\r\n                type: this.sdp.type,\r\n            };\r\n        }\r\n        this.sdp = modifiedSdp;\r\n    }\r\n    shouldAddSupportForHighQualityStream(options) {\r\n        return (options.contents?.includes('slides') ||\r\n            (options?.allow1080p && options.videoAS && options.videoAS >= 2564));\r\n    }\r\n    setContentAttribute(mline, content) {\r\n        if (!mline || !content) {\r\n            return;\r\n        }\r\n        mline.content = content;\r\n    }\r\n    addBandwidthLine(sdp, videoAS, videoTIAS) {\r\n        const videoLines = this.getVideoLines(sdp.media);\r\n        videoLines.forEach(videoLine => {\r\n            if (!videoLine.bandwidth) {\r\n                videoLine.bandwidth = [];\r\n            }\r\n            const TIAS = videoLine.bandwidth.find(({ type }) => type === 'TIAS');\r\n            const limit = Number(TIAS?.limit);\r\n            if (limit && videoTIAS && limit < videoTIAS) {\r\n                // Don't override upper limit provided by MCU\r\n                return;\r\n            }\r\n            videoLine.bandwidth.push({\r\n                type: 'AS',\r\n                limit: videoAS,\r\n            });\r\n            if (videoTIAS) {\r\n                // For FF we should include this to the media line\r\n                // (required only for outgoing stream)\r\n                if (TIAS) {\r\n                    TIAS.limit = videoTIAS;\r\n                }\r\n                else {\r\n                    videoLine.bandwidth.push({\r\n                        type: 'TIAS',\r\n                        limit: videoTIAS,\r\n                    });\r\n                }\r\n            }\r\n        });\r\n        return sdp;\r\n    }\r\n    addSupportForHighQualityStream(sdp, allow4kPreso = false) {\r\n        const videoLines = this.getVideoLines(sdp.media);\r\n        videoLines.forEach(videoLine => {\r\n            const codecs = this.getCodecs(videoLine.rtp);\r\n            videoLine.fmtp = videoLine.fmtp.map(fmtp => {\r\n                if (fmtp.config.includes('max-fs')) {\r\n                    return fmtp;\r\n                }\r\n                const codec = codecs[fmtp.payload];\r\n                const is4kPreso = isPreso(videoLine) && allow4kPreso;\r\n                if (codec === Codec.VP8 || codec === Codec.VP9) {\r\n                    fmtp.config += this.getVPXConfigOverrides(is4kPreso);\r\n                }\r\n                else if (codec === Codec.H264) {\r\n                    fmtp.config += this.getH264ConfigOverrides(is4kPreso);\r\n                }\r\n                return fmtp;\r\n            });\r\n        });\r\n        return sdp;\r\n    }\r\n    getVPXConfigOverrides(is4kEnabled = false) {\r\n        return `;max-fs=${is4kEnabled ? '36864' : '8160'};max-fr=30`;\r\n    }\r\n    getH264ConfigOverrides(is4kEnabled = false) {\r\n        return is4kEnabled\r\n            ? ';max-br=32768;max-mbps=2073600;max-fs=36864;max-smbps=2073600;max-fps=6000;max-fr=30'\r\n            : ';max-br=3732;max-mbps=245760;max-fs=8192;max-smbps=245760;max-fps=3000;max-fr=30';\r\n    }\r\n    /**\r\n     * This method makes sure we pick set of supported codecs with the right order\r\n     */\r\n    chooseVideoPTs(sdp) {\r\n        const videoLines = this.getVideoLines(sdp.media);\r\n        videoLines.forEach(videoLine => {\r\n            /**\r\n             * To reject an offered\r\n             * stream, the port number in the corresponding stream in the answer\r\n             * MUST be set to zero. Any media formats listed are ignored.\r\n             *\r\n             * Ref: https://www.rfc-editor.org/rfc/rfc3264#section-6\r\n             */\r\n            if (videoLine.port === 0 && this.sdp.type === 'answer') {\r\n                return;\r\n            }\r\n            const codecs = this.getCodecs(videoLine.rtp);\r\n            let payloadTypes = [];\r\n            for (const fmtp of videoLine.fmtp) {\r\n                if (codecs[fmtp.payload] !== Codec.H264) {\r\n                    continue;\r\n                }\r\n                const params = fmtp.config.split(';');\r\n                /**\r\n                 * The profile-level-id parameter indicates the default sub-\r\n                 * profile (i.e., the subset of coding tools that may have been\r\n                 * used to generate the stream or that the receiver supports) and\r\n                 * the default level of the stream or the receiver supports.\r\n                 *\r\n                 * Ref: https://datatracker.ietf.org/doc/html/rfc6184#page-41 (Table 5)\r\n                 */\r\n                const [, profile] = params\r\n                    .find(param => param.includes('profile-level-id'))\r\n                    ?.split('=') ?? [];\r\n                /**\r\n                 * The default sub-profile is indicated collectively by the\r\n                 * profile_idc byte and some fields in the profile-iop byte.\r\n                 *\r\n                 * Ref: https://datatracker.ietf.org/doc/html/rfc6184#page-41 (Table 5)\r\n                 */\r\n                const profileIdc = profile?.substring(0, 2);\r\n                const profileIop = profile?.substring(2, 4) ?? '';\r\n                /**\r\n                 * Profile      profile_idc         profile-iop\r\n                 *              (hexadecimal)       (binary)\r\n                 *\r\n                 *  CB           42 (B)             x1xx0000\r\n                 *      same as: 4D (M)             1xxx0000\r\n                 *      same as: 58 (E)             11xx0000\r\n                 *  B            42 (B)             x0xx0000\r\n                 *      same as: 58 (E)             10xx0000\r\n                 *\r\n                 * Where:\r\n                 * CB: Constrained Baseline profile\r\n                 * B:  Baseline profile\r\n                 */\r\n                if (profileIdc !== '42') {\r\n                    continue;\r\n                }\r\n                /**\r\n                 * Add all B/CB keys unless we find CB key together with packetization-mode=1\r\n                 * Then we use only that one\r\n                 * Because there seems to be a bug with CB key and packetization-mode=0\r\n                 */\r\n                if (parseInt('0x' + profileIop) & 0x40 && // CB otherwise B\r\n                    fmtp.config.includes('packetization-mode=1')) {\r\n                    payloadTypes = [fmtp.payload];\r\n                    break;\r\n                }\r\n                payloadTypes.push(fmtp.payload);\r\n            }\r\n            // now filter based on the above\r\n            videoLine.rtp = videoLine.rtp.filter(({ codec, payload }) => {\r\n                if (codec === Codec.H264) {\r\n                    return payloadTypes.includes(payload);\r\n                }\r\n                const fmtp = videoLine.fmtp.find(line => line.payload === payload);\r\n                return this.shouldStripH264Line(fmtp?.config ?? '', payloadTypes, codecs);\r\n            });\r\n            videoLine.fmtp = videoLine.fmtp.filter(({ payload, config }) => {\r\n                if (codecs[payload] === Codec.H264 &&\r\n                    !payloadTypes.includes(payload)) {\r\n                    return false;\r\n                }\r\n                return this.shouldStripH264Line(config, payloadTypes, codecs);\r\n            });\r\n            if (videoLine.rtcpFb) {\r\n                videoLine.rtcpFb = videoLine.rtcpFb.filter(({ payload }) => codecs[payload] !== Codec.H264 ||\r\n                    (codecs[payload] === Codec.H264 &&\r\n                        payloadTypes.includes(payload)));\r\n            }\r\n            // Put higher priority on the payloadTypes\r\n            const payloads = [\r\n                ...payloadTypes,\r\n                ...videoLine.rtp.flatMap(({ payload }) => !payloadTypes.includes(Number(payload)) ? [payload] : []),\r\n            ];\r\n            // Make sure we only apply this logic if we found any payloads\r\n            // otherwise we can hit validation error\r\n            if (videoLine.payloads && payloads.length > 0) {\r\n                videoLine.payloads = payloads.join(' ');\r\n            }\r\n        });\r\n        return sdp;\r\n    }\r\n    shouldStripH264Line(config, payloadTypes, codecs) {\r\n        const [name, value] = config.split('=');\r\n        if (name === 'apt' &&\r\n            value &&\r\n            codecs[value] === Codec.H264 &&\r\n            !payloadTypes.includes(Number(value))) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    stripCodecs(sdp, disableCodecs) {\r\n        const videoLines = this.getVideoLines(sdp.media);\r\n        for (const videoLine of videoLines) {\r\n            if (videoLine) {\r\n                const removePayloads = videoLine.rtp\r\n                    .filter(({ codec }) => disableCodecs.includes(codec))\r\n                    .map(({ payload }) => payload);\r\n                if (removePayloads.length > 0) {\r\n                    const rtxApts = removePayloads.map(item => `apt=${item}`);\r\n                    const rtxPayloads = videoLine.fmtp.filter(item => rtxApts.includes(item.config));\r\n                    removePayloads.push(...rtxPayloads.map(item => item.payload));\r\n                }\r\n                if (videoLine.payloads) {\r\n                    for (const payload of removePayloads) {\r\n                        videoLine.payloads = videoLine.payloads.replace(`${payload} `, '');\r\n                    }\r\n                }\r\n                videoLine.rtp = videoLine.rtp.filter(rtp => !removePayloads.includes(rtp.payload));\r\n                videoLine.fmtp = videoLine.fmtp.filter(fmtp => !removePayloads.includes(fmtp.payload));\r\n                if (videoLine.rtcpFb) {\r\n                    videoLine.rtcpFb = videoLine.rtcpFb.filter(rtcpFb => !removePayloads.includes(rtcpFb.payload));\r\n                }\r\n            }\r\n        }\r\n        return sdp;\r\n    }\r\n    getVideoLines(media) {\r\n        return media.filter(line => line.type === 'video');\r\n    }\r\n    getMediaLine(media, mid) {\r\n        if (mid) {\r\n            return media.find(line => (line.type === 'video' || line.type === 'audio') &&\r\n                String(line.mid) === mid);\r\n        }\r\n    }\r\n    getCodecs(rtp) {\r\n        return rtp.reduce((acc, { codec, payload }) => {\r\n            acc[payload] = codec;\r\n            return acc;\r\n        }, {});\r\n    }\r\n}\r\nexport const hasICECandidates = (sdp) => {\r\n    if (!sdp) {\r\n        return false;\r\n    }\r\n    const transformedSDP = sdpTransform.parse(sdp);\r\n    return transformedSDP.media.some(m => m.candidates && m.candidates.length > 0);\r\n};\r\nexport const getMediaLines = (sdp) => {\r\n    if (!sdp) {\r\n        return [];\r\n    }\r\n    return sdpTransform.parse(sdp).media;\r\n};\r\nexport const isPreso = (media) => media.content === 'slides';\r\n", "import { RecoveryTimeout } from './types';\r\nimport { SdpTransformManager, getMediaLines, hasICECandidates, } from './sdpManager';\r\nimport { CAN_SET_STREAMS } from './constants';\r\nimport { changeTransceiverDirection, createEventQueue, createGetRefs, createMediaConfigs, createRTCPeerConnection, createRefsLog, getPeerConnectionStates, getRelativeDirection, isDataChannelConfig, isTransceiverConfig, isTransceiverObsolete, logReferences, withSignals, } from './utils';\r\nconst MAX_M_CONTENT_COUNT = 10;\r\nconst MAX_DEFER_NEGOTIATION_COUNT = 10;\r\n/**\r\n * Wrap RTCPeerConnection with polyfill the old APIs and simplifies the common logics\r\n *\r\n * @param options - Configuration for the peer connection\r\n * @param peerConnection - Inject your own RTCPeerConnection, can be used for\r\n * testing\r\n */\r\nexport function createPeerConnection(options = {}, peerConnection) {\r\n    const props = {\r\n        bandwidth: options.bandwidth ?? 0,\r\n        offerOptions: options.offerOptions,\r\n        answerOptions: options.answerOptions,\r\n        references: {\r\n            module: 'PeerConnection',\r\n            createdAt: new Date().toISOString(),\r\n        },\r\n        allowCodecSdpMunging: Boolean(options.allowCodecSdpMunging),\r\n        // Only used when `restartIce` is not available\r\n        iceRestartNeeded: false,\r\n        initialConnectionDone: false,\r\n        makingOffer: false,\r\n        makingAnswer: false,\r\n        ignoreNegotiationNeeded: false,\r\n        pendingOffer: undefined,\r\n        allowVP9: options.allowVP9 ?? true,\r\n        allow1080p: options.allow1080p,\r\n        allow4kPreso: options.allow4kPreso,\r\n        currentRemoteDescription: undefined,\r\n        localFingerprints: [],\r\n        remoteFingerprints: [],\r\n        mediaContentMismatchCount: 0,\r\n        deferNegotiationCount: 0,\r\n        polite: !!options.polite,\r\n    };\r\n    const mediaConfigs = createMediaConfigs(options.mediaInits, () => eventHandlers.onTransceiverChange?.());\r\n    let remoteMediaLines = new Map();\r\n    const timers = {};\r\n    const clearTimer = (timerKey, onDone) => {\r\n        if (timers[timerKey]) {\r\n            clearTimeout(timers[timerKey]);\r\n            timers[timerKey] = undefined;\r\n            onDone?.();\r\n        }\r\n    };\r\n    const eventHandlers = {};\r\n    const localICECandidateQueue = createEventQueue((evt) => {\r\n        eventHandlers.onIceCandidate?.(evt);\r\n    });\r\n    const pcEventListeners = [\r\n        {\r\n            event: 'iceconnectionstatechange',\r\n            listener: event => {\r\n                log.info('handle iceconnectionstatechange event', { event });\r\n                const pc = event.currentTarget;\r\n                clearTimer('iceConnectionState', () => {\r\n                    log.debug('clears the restart ice timer', { event });\r\n                });\r\n                if (pc.iceConnectionState === 'failed') {\r\n                    // FIXME: Should update configuration before restarting ICE\r\n                    log.debug('restarts ice because it went to failed', {\r\n                        event,\r\n                    });\r\n                    restartIce();\r\n                }\r\n                else if (pc.iceConnectionState === 'disconnected') {\r\n                    log.debug('schedule ice restart because it went to disconnected', {\r\n                        event,\r\n                    });\r\n                    timers.iceConnectionState = window.setTimeout(restartIce, RecoveryTimeout.IceConnectionState);\r\n                }\r\n                if (eventHandlers.iceConnectionStateChange) {\r\n                    eventHandlers.iceConnectionStateChange(event);\r\n                }\r\n            },\r\n        },\r\n        {\r\n            event: 'signalingstatechange',\r\n            listener: event => {\r\n                log.info('handle signalingstatechange event', { event });\r\n                const pc = event.currentTarget;\r\n                if (pc.signalingState === 'stable') {\r\n                    if (props.iceRestartNeeded &&\r\n                        eventHandlers.onIceCandidate) {\r\n                        fallbackRestartIce();\r\n                    }\r\n                }\r\n                if (eventHandlers.signalingStateChange) {\r\n                    eventHandlers.signalingStateChange(event);\r\n                }\r\n            },\r\n        },\r\n        {\r\n            event: 'icecandidate',\r\n            listener: event => {\r\n                if (!eventHandlers.onIceCandidate) {\r\n                    return;\r\n                }\r\n                if (props.makingAnswer ||\r\n                    props.makingOffer ||\r\n                    localICECandidateQueue.buffering) {\r\n                    log.debug('buffering ICE candidate', {\r\n                        event,\r\n                        makingOffer: props.makingOffer,\r\n                        makingAnswer: props.makingAnswer,\r\n                        localICECandidateBuffering: localICECandidateQueue.buffering,\r\n                    });\r\n                    localICECandidateQueue.buffering = true;\r\n                }\r\n                localICECandidateQueue.enqueue(event);\r\n            },\r\n        },\r\n        {\r\n            event: 'negotiationneeded',\r\n            listener: () => {\r\n                log.info('handle negotiationneeded event', { eventHandlers });\r\n                if (eventHandlers.negotiationNeeded) {\r\n                    negotiate();\r\n                }\r\n            },\r\n        },\r\n        {\r\n            event: 'track',\r\n            listener: event => {\r\n                log.info('handle track event', {\r\n                    event,\r\n                    remoteMediaLines,\r\n                    mediaConfigs,\r\n                });\r\n                const config = mediaConfigs.getConfig(event.transceiver) ??\r\n                    mediaConfigs.find(config => {\r\n                        if (!isTransceiverConfig(config)) {\r\n                            return false;\r\n                        }\r\n                        const media = remoteMediaLines.get(event.transceiver.mid ?? '');\r\n                        const content = media?.content ?? 'main';\r\n                        const kind = media?.type;\r\n                        return (kind === config.kind && content === config.content);\r\n                    });\r\n                if (!isTransceiverConfig(config)) {\r\n                    log.warn('Unable to find respective transceiver config', {\r\n                        mediaConfigs,\r\n                        event,\r\n                    });\r\n                    eventHandlers.onTrack?.(event);\r\n                    return;\r\n                }\r\n                config.remoteStreams = event.streams.length\r\n                    ? event.streams\r\n                    : [new MediaStream([event.track])];\r\n                eventHandlers.onRemoteStreams?.(config);\r\n                eventHandlers.onTrack?.(event);\r\n            },\r\n        },\r\n        {\r\n            event: 'datachannel',\r\n            listener: event => {\r\n                log.info('handle datachannel event', {\r\n                    event,\r\n                    eventHandler: eventHandlers.onDataChannel,\r\n                });\r\n                const config = mediaConfigs.find(config => isDataChannelConfig(config) && !config.dataChannel);\r\n                if (isDataChannelConfig(config)) {\r\n                    config.dataChannel = event.channel;\r\n                }\r\n                eventHandlers.onDataChannel?.(event);\r\n            },\r\n        },\r\n    ];\r\n    const peer = createRTCPeerConnection(options.rtcConfig, pcEventListeners, peerConnection);\r\n    // HACK: Fix for odd Firefox behavior, see: https://github.com/feross/simple-peer/pull/783\r\n    if (typeof peer.peerIdentity === 'object') {\r\n        peer.peerIdentity.catch((error) => {\r\n            log.error('peerIdentity error', { error });\r\n            peer.close();\r\n        });\r\n    }\r\n    const log = createRefsLog(() => ({\r\n        ...logReferences(props.references),\r\n        ...getPeerConnectionStates(peer),\r\n        props,\r\n    }));\r\n    /**\r\n     * `RTCRtpSender['setStreams']` fallback function with polyfill when the API is not available\r\n     * by using SDP mangling\r\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCRtpSender/setStreams}\r\n     */\r\n    const associateStream = ({ transceiver, stream, sdp, sdpOptions, }) => {\r\n        const sdpManager = sdp instanceof SdpTransformManager\r\n            ? sdp\r\n            : new SdpTransformManager(sdp, sdpOptions);\r\n        sdpManager.addMsidToMline(transceiver, stream.id);\r\n    };\r\n    /**\r\n     * Polyfill to browsers without RTCRtpSender['setStreams'] with SDP Mangling\r\n     * */\r\n    const associateStreamWithSDP = ({ streams, transceiver }, sdp, sdpOptions) => {\r\n        const [stream] = streams;\r\n        if (!stream || !transceiver) {\r\n            return;\r\n        }\r\n        log.debug('Manual associate stream with SDP', {\r\n            sdp: sdp,\r\n            options: sdpOptions,\r\n            stream,\r\n            currentLocalDescription: peer.currentLocalDescription,\r\n            transceivers: peer.getTransceivers(),\r\n            transceiver,\r\n        });\r\n        associateStream({\r\n            transceiver,\r\n            stream,\r\n            sdp,\r\n            sdpOptions,\r\n        });\r\n    };\r\n    /**\r\n     * Set the local `MediaStream`, and replace the tracks when there is already\r\n     * one in the process\r\n     *\r\n     * @param mediaStream - the media stream to add\r\n     * @param targets - A list a target `TransceiverConfig` to update the stream\r\n     */\r\n    const setLocalStream = async (mediaStream, targets, shouldSyncMedia = true) => {\r\n        log.info('call setLocalStream', { mediaStream, targets });\r\n        const streams = mediaStream ? [mediaStream] : [];\r\n        for (const [config, intentDirection] of targets) {\r\n            const direction = changeTransceiverDirection(config.transceiver?.currentDirection ?? config.direction, intentDirection);\r\n            const track = mediaStream\r\n                ?.getTracks()\r\n                .find(track => track.kind === config.kind &&\r\n                track.readyState === 'live') ?? null;\r\n            config.track = track;\r\n            config.streams = streams;\r\n            config.direction = direction;\r\n        }\r\n        if (shouldSyncMedia) {\r\n            await syncMedia(remoteMediaLines, true);\r\n        }\r\n    };\r\n    /**\r\n     * Trigger manual negotiationNeeded event\r\n     */\r\n    const negotiate = () => {\r\n        clearTimer('negotiation');\r\n        if (props.mediaContentMismatchCount >= MAX_M_CONTENT_COUNT) {\r\n            log.info('Failed to negotiate with remote peer because of transceiver content attribute mismatch');\r\n            props.mediaContentMismatchCount = 0;\r\n            return;\r\n        }\r\n        if (props.deferNegotiationCount >= MAX_DEFER_NEGOTIATION_COUNT) {\r\n            log.info('Defer negotiation is more than allowed');\r\n            props.deferNegotiationCount = 0;\r\n            return;\r\n        }\r\n        if (eventHandlers.negotiationNeeded) {\r\n            if (!props.ignoreNegotiationNeeded &&\r\n                !props.makingOffer &&\r\n                peer.signalingState === 'stable') {\r\n                log.info('call negotiationneeded handler');\r\n                props.deferNegotiationCount = 0;\r\n                eventHandlers.negotiationNeeded();\r\n            }\r\n            else {\r\n                log.info('defer negotiation', {\r\n                    ignoreNegotiationNeeded: props.ignoreNegotiationNeeded,\r\n                    makingOffer: props.makingOffer,\r\n                    signalingState: peer.signalingState,\r\n                });\r\n                props.deferNegotiationCount += 1;\r\n                timers.negotiation = window.setTimeout(negotiate, RecoveryTimeout.Negotiation);\r\n            }\r\n        }\r\n        else {\r\n            log.warn('[negotiate] try to negotiate but no negotiationneeded handler');\r\n        }\r\n    };\r\n    /**\r\n     * Trigger iceRestart manual mode\r\n     */\r\n    const fallbackRestartIce = () => {\r\n        log.info('[restartIce fallback] trigger negotiationneeded manually');\r\n        props.offerOptions = { ...props.offerOptions, iceRestart: true };\r\n        props.iceRestartNeeded = false;\r\n        negotiate();\r\n    };\r\n    /**\r\n     * The WebRTC API's `RTCPeerConnection` interface offers the `restartIce()`\r\n     * method to allow a web application to easily request that ICE candidate\r\n     * gathering be redone on both ends of the connection. This simplifies the\r\n     * process by allowing the same method to be used by either the caller or\r\n     * the receiver to trigger an ICE restart.\r\n     *\r\n     * This function includes the logic to check if the latest API is available,\r\n     * and use the fallback, `RTCPeerConnection['createOffer']` with\r\n     * `iceRestart` set to `true`.\r\n     */\r\n    const restartIce = () => {\r\n        if (!eventHandlers.onIceCandidate) {\r\n            // Don't support Vanilla ICE Restart\r\n            return;\r\n        }\r\n        clearTimer('connectionState', () => {\r\n            log.debug('clears connectionStateTimer due to iceRestart');\r\n        });\r\n        if (peer.restartIce !== undefined) {\r\n            log.info('restartIce');\r\n            peer.restartIce();\r\n        }\r\n        else {\r\n            // Fallback restartIce to a manual mode\r\n            if (peer.signalingState === 'stable') {\r\n                log.info('restartIce fallback');\r\n                fallbackRestartIce();\r\n            }\r\n            else {\r\n                // Wait for `signalingState` changes to `stable` to restartIce\r\n                props.iceRestartNeeded = true;\r\n                log.info('restartIce fallback deferred');\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Calculate the secure check code from the local and remote fingerprints\r\n     */\r\n    const calculateSecureCheckCode = async () => {\r\n        log.info('calculateSecureCheckCode');\r\n        if (props.localFingerprints.length && props.remoteFingerprints.length) {\r\n            // Sort to ensure deterministic behaviour\r\n            const local = props.localFingerprints\r\n                .map(({ type, hash }) => type + hash)\r\n                .sort()\r\n                .join('');\r\n            const remote = props.remoteFingerprints\r\n                .map(({ type, hash }) => type + hash)\r\n                .sort()\r\n                .join('');\r\n            const msg = [local, remote].sort().join('');\r\n            // SHA-256 hash the result\r\n            const msgBuffer = new TextEncoder().encode(msg);\r\n            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);\r\n            const hashArray = Array.from(new Uint8Array(hashBuffer));\r\n            const hashHex = hashArray\r\n                .map(b => b.toString(16).padStart(2, '0'))\r\n                .join('');\r\n            eventHandlers.onSecureCheckCode?.(hashHex);\r\n        }\r\n    };\r\n    /**\r\n     * Two-way sync of transceivers & data channel between `PeerConnection` and `mediaConfigs`\r\n     * Should only be called after the offer/answer is applied\r\n     *\r\n     * @param remoteMediaLines - The remote media lines\r\n     * @param active - Indicate it is an active sync, e.g. creating an offer\r\n     *\r\n     * @internal\r\n     */\r\n    const syncMedia = async (remoteMediaLines, active) => {\r\n        if (peer.connectionState === 'closed') {\r\n            return;\r\n        }\r\n        const currentTransceivers = peer.getTransceivers();\r\n        log.info('Sync Media', {\r\n            currentTransceivers,\r\n            mediaConfigs,\r\n            remoteMediaLines,\r\n            active,\r\n        });\r\n        try {\r\n            props.ignoreNegotiationNeeded = true;\r\n            // PeerConnection's transceivers => MediaConfigs\r\n            const transceivers = new Map(currentTransceivers.flatMap(trans => isTransceiverObsolete(trans) ? [] : [[trans.mid, trans]]));\r\n            // Matching the remote SDP's media descriptions\r\n            for (const remoteMedia of remoteMediaLines.values()) {\r\n                const remoteContent = remoteMedia.content ?? 'main';\r\n                const mid = String(remoteMedia.mid);\r\n                const relativeDirection = active\r\n                    ? undefined\r\n                    : getRelativeDirection(remoteMedia.direction);\r\n                switch (remoteMedia.type) {\r\n                    case 'application': {\r\n                        // Look for the data channel with respective ID\r\n                        const config = mediaConfigs.find(config => isDataChannelConfig(config) &&\r\n                            !!config.options.negotiated &&\r\n                            String(config.options.id) === mid);\r\n                        if (config) {\r\n                            log.debug(`Sync existing ${config} data channel config`, {\r\n                                remoteMedia,\r\n                                config,\r\n                                mediaConfigs,\r\n                            });\r\n                            config.syncDataChannel(peer);\r\n                        }\r\n                        break;\r\n                    }\r\n                    case 'audio':\r\n                    case 'video': {\r\n                        const transceiver = transceivers.get(mid);\r\n                        if (!transceiver) {\r\n                            throw new Error(`Cannot find respective Transceiver with mid:${mid}`);\r\n                        }\r\n                        const existingConfig = mediaConfigs.getConfig(transceiver);\r\n                        if (existingConfig) {\r\n                            log.debug(`Sync existing ${existingConfig} transceiver config`, {\r\n                                transceiver,\r\n                                remoteMedia,\r\n                                mediaConfigs,\r\n                            });\r\n                            if (existingConfig.content !== remoteContent) {\r\n                                log.warn(`(local:content) ${existingConfig.content} <==> (remote:content) ${remoteMedia.content}`, { remoteMedia, localConfig: existingConfig });\r\n                                props.mediaContentMismatchCount++;\r\n                                continue;\r\n                            }\r\n                            await existingConfig.syncTransceiver(peer, {\r\n                                direction: existingConfig.relativeDirection\r\n                                    ? relativeDirection\r\n                                    : undefined,\r\n                            });\r\n                        }\r\n                        else {\r\n                            const matchedConfig = mediaConfigs.find(config => {\r\n                                // Get the first matching config\r\n                                return (isTransceiverConfig(config) &&\r\n                                    (!config.transceiver ||\r\n                                        isTransceiverObsolete(config.transceiver)) &&\r\n                                    // Assume it is `main` when no content attribute is set\r\n                                    config.content === remoteContent &&\r\n                                    config.kind === remoteMedia.type);\r\n                            });\r\n                            if (matchedConfig) {\r\n                                log.debug(`found matched ${matchedConfig} transceiver config`, {\r\n                                    transceiver,\r\n                                    matchedConfig,\r\n                                    remoteMedia,\r\n                                });\r\n                                matchedConfig.transceiver = transceiver;\r\n                                await matchedConfig.syncTransceiver(peer, {\r\n                                    direction: matchedConfig.relativeDirection\r\n                                        ? relativeDirection\r\n                                        : undefined,\r\n                                });\r\n                            }\r\n                            else {\r\n                                log.debug('Transceiver config mismatched, adding a new config', { transceiver, remoteMedia, mediaConfigs });\r\n                                const newConfig = mediaConfigs.addConfig(peer, {\r\n                                    kindOrTrack: transceiver.sender.track ??\r\n                                        remoteMedia.type,\r\n                                    content: remoteMedia.content ?? 'main',\r\n                                    transceiver,\r\n                                    direction: relativeDirection,\r\n                                });\r\n                                await newConfig.syncTransceiver(peer);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    default: {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // According to RFC3264#Section 6:\r\n            // For each \"m=\" line in the offer, there MUST be a corresponding \"m=\"\r\n            // line in the answer.  The answer MUST contain exactly the same number\r\n            // of \"m=\" lines as the offer.\r\n            // Only Sync media based on the configs when it is Offer aka `active===true`\r\n            if (!active) {\r\n                return;\r\n            }\r\n            for (const config of mediaConfigs.configs) {\r\n                if (isTransceiverConfig(config)) {\r\n                    await config.syncTransceiver(peer);\r\n                }\r\n                if (isDataChannelConfig(config)) {\r\n                    config.syncDataChannel(peer);\r\n                }\r\n            }\r\n        }\r\n        finally {\r\n            props.ignoreNegotiationNeeded = false;\r\n            props.initialConnectionDone = true;\r\n        }\r\n    };\r\n    const createOffer = async (offerOptions) => {\r\n        log.info('call createOffer', { param: offerOptions, peer });\r\n        props.makingOffer = true;\r\n        try {\r\n            const sdp = await peer.createOffer({\r\n                ...props.offerOptions,\r\n                ...offerOptions,\r\n            });\r\n            log.debug('created raw Offer', { sdp });\r\n            const sdpManager = new SdpTransformManager(sdp, {\r\n                allow1080p: props.allow1080p,\r\n                allow4kPreso: props.allow4kPreso,\r\n                allowCodecSdpMunging: props.allowCodecSdpMunging,\r\n                allowVP9: props.allowVP9,\r\n                contents: mediaConfigs.configs.flatMap(config => isTransceiverConfig(config) ? [config.content] : []),\r\n                sendEncodings: mediaConfigs.configs.flatMap(config => isTransceiverConfig(config)\r\n                    ? [config.sendEncodings ?? []]\r\n                    : []),\r\n                videoAS: props.bandwidth,\r\n            });\r\n            let offer = sdpManager.getSdp();\r\n            if (peer.signalingState !== 'stable') {\r\n                throw new Error('Ignore');\r\n            }\r\n            await peer.setLocalDescription(offer);\r\n            if (!CAN_SET_STREAMS) {\r\n                mediaConfigs.configs.forEach(config => {\r\n                    if (config.kind === 'video' || config.kind === 'audio') {\r\n                        associateStreamWithSDP(config, sdpManager);\r\n                    }\r\n                });\r\n            }\r\n            offer = sdpManager.getSdp();\r\n            log.info('setLocalDescription with offer success', {\r\n                rawSDP: sdp,\r\n                offer,\r\n            });\r\n            props.localFingerprints = sdpManager.getFingerprints();\r\n            await calculateSecureCheckCode();\r\n            return offer;\r\n        }\r\n        finally {\r\n            props.makingOffer = false;\r\n        }\r\n    };\r\n    return {\r\n        get peer() {\r\n            return peer;\r\n        },\r\n        get polite() {\r\n            return props.polite;\r\n        },\r\n        get iceGatheringState() {\r\n            return peer.iceGatheringState;\r\n        },\r\n        get iceConnectionState() {\r\n            return peer.iceConnectionState;\r\n        },\r\n        get signalingState() {\r\n            return peer.signalingState;\r\n        },\r\n        get connectionState() {\r\n            return peer.connectionState;\r\n        },\r\n        get senders() {\r\n            return peer.getSenders();\r\n        },\r\n        get receivers() {\r\n            return peer.getReceivers();\r\n        },\r\n        get configs() {\r\n            return mediaConfigs.configs;\r\n        },\r\n        getTransceiverConfigs: () => {\r\n            return mediaConfigs.configs.filter(isTransceiverConfig);\r\n        },\r\n        getDataChannelConfigs: () => {\r\n            return mediaConfigs.configs.filter(isDataChannelConfig);\r\n        },\r\n        addConfig: mediaConfigs.addConfig,\r\n        releaseLocalICECandidatesBuffer: ignore => {\r\n            if (!eventHandlers.onIceCandidate) {\r\n                return;\r\n            }\r\n            localICECandidateQueue.buffering = false;\r\n            if (!ignore && localICECandidateQueue.length) {\r\n                const eventFlushed = localICECandidateQueue.flush();\r\n                log.debug('Release buffered local ICE candidates', {\r\n                    events: eventFlushed,\r\n                });\r\n                return;\r\n            }\r\n            localICECandidateQueue.discard();\r\n        },\r\n        get hasICECandidates() {\r\n            return hasICECandidates(peer.pendingLocalDescription?.sdp ??\r\n                peer.currentLocalDescription?.sdp);\r\n        },\r\n        get currentLocalDescription() {\r\n            if (peer.currentLocalDescription !== undefined) {\r\n                return peer.currentLocalDescription;\r\n            }\r\n            return peer.localDescription;\r\n        },\r\n        get pendingLocalDescription() {\r\n            if (peer.pendingLocalDescription !== undefined) {\r\n                return peer.pendingLocalDescription ?? undefined;\r\n            }\r\n            return peer.signalingState === 'stable' ||\r\n                peer.localDescription === null\r\n                ? undefined\r\n                : peer.localDescription;\r\n        },\r\n        get currentRemoteDescription() {\r\n            if (peer.currentRemoteDescription !== undefined) {\r\n                return peer.currentRemoteDescription;\r\n            }\r\n            return peer.remoteDescription;\r\n        },\r\n        get pendingRemoteDescription() {\r\n            if (peer.pendingRemoteDescription !== undefined) {\r\n                return peer.pendingRemoteDescription;\r\n            }\r\n            return peer.signalingState === 'stable'\r\n                ? null\r\n                : peer.remoteDescription;\r\n        },\r\n        get bandwidth() {\r\n            return props.bandwidth;\r\n        },\r\n        get references() {\r\n            return props.references;\r\n        },\r\n        get offerOptions() {\r\n            return props.offerOptions;\r\n        },\r\n        set offerOptions(newOptions) {\r\n            props.offerOptions = { ...props.offerOptions, ...newOptions };\r\n        },\r\n        get answerOptions() {\r\n            return props.answerOptions;\r\n        },\r\n        set answerOptions(newOptions) {\r\n            log.info('set answerOptions', {\r\n                newOptions,\r\n                answerOptions: props.answerOptions,\r\n            });\r\n            props.answerOptions = { ...props.answerOptions, ...newOptions };\r\n        },\r\n        set bandwidth(bandwidth) {\r\n            log.info('set bandwidth', {\r\n                newBandwidth: bandwidth,\r\n                bandwidth: props.bandwidth,\r\n            });\r\n            if (props.bandwidth !== bandwidth) {\r\n                props.bandwidth = bandwidth;\r\n                negotiate();\r\n            }\r\n        },\r\n        set negotiationNeeded(needed) {\r\n            if (needed) {\r\n                negotiate();\r\n            }\r\n        },\r\n        negotiate: async () => {\r\n            return syncMedia(remoteMediaLines, true);\r\n        },\r\n        getStats: async (selector) => await peer.getStats(selector),\r\n        setLocalStream,\r\n        setReference(key, value) {\r\n            log.info('call setReference', {\r\n                references: props.references,\r\n                key,\r\n                value,\r\n            });\r\n            props.references[key] = value;\r\n        },\r\n        createDataChannel: (label, dataChannelDict) => {\r\n            log.info('call createDataChannel', { label, dataChannelDict });\r\n            return peer.createDataChannel(label, dataChannelDict);\r\n        },\r\n        createOffer,\r\n        createAnswer: async (answerOptions) => {\r\n            log.info('call createAnswer', { param: answerOptions });\r\n            props.makingAnswer = true;\r\n            try {\r\n                const sdp = await peer.createAnswer({\r\n                    ...props.answerOptions,\r\n                    ...answerOptions,\r\n                });\r\n                log.debug('created raw Answer', { sdp });\r\n                const sdpManager = new SdpTransformManager(sdp, {\r\n                    allow4kPreso: props.allow4kPreso,\r\n                    allowCodecSdpMunging: props.allowCodecSdpMunging,\r\n                    allowVP9: props.allowVP9,\r\n                    videoAS: props.bandwidth,\r\n                });\r\n                mediaConfigs.configs.forEach(config => {\r\n                    if (isTransceiverConfig(config) &&\r\n                        config.transceiver?.mid) {\r\n                        sdpManager.addContentAttribute(config.transceiver.mid, config.content);\r\n                    }\r\n                });\r\n                let answer = sdpManager.getSdp();\r\n                await peer.setLocalDescription(answer);\r\n                if (!CAN_SET_STREAMS) {\r\n                    mediaConfigs.configs.forEach(config => {\r\n                        if (config.kind === 'video' ||\r\n                            config.kind === 'audio') {\r\n                            associateStreamWithSDP(config, sdpManager);\r\n                        }\r\n                    });\r\n                }\r\n                answer = sdpManager.getSdp();\r\n                log.info('setLocalDescription with answer success', {\r\n                    rawSDP: sdp,\r\n                    answer,\r\n                });\r\n                props.localFingerprints = sdpManager.getFingerprints();\r\n                await calculateSecureCheckCode();\r\n                return answer;\r\n            }\r\n            finally {\r\n                props.makingAnswer = false;\r\n            }\r\n        },\r\n        receiveAnswer: async (answer) => {\r\n            log.info('call receiveAnswer', { answer });\r\n            remoteMediaLines = new Map(getMediaLines(answer.sdp).map(mline => [\r\n                String(mline.mid),\r\n                mline,\r\n            ]));\r\n            const sdpManager = new SdpTransformManager(answer, {\r\n                allowCodecSdpMunging: props.allowCodecSdpMunging,\r\n                allowVP9: props.allowVP9,\r\n                videoAS: props.bandwidth,\r\n                videoTIAS: props.bandwidth * 1000,\r\n            });\r\n            await peer.setRemoteDescription(sdpManager.getSdp());\r\n            log.debug('setRemoteDescription success', {\r\n                currentTransceivers: peer.getTransceivers(),\r\n                mediaConfigs,\r\n            });\r\n            props.remoteFingerprints = sdpManager.getFingerprints();\r\n            await calculateSecureCheckCode();\r\n            props.currentRemoteDescription = answer;\r\n        },\r\n        receiveOffer: async (offer) => {\r\n            log.info('call receiveOffer', { offer });\r\n            remoteMediaLines = new Map(getMediaLines(offer.sdp).map(mline => [\r\n                String(mline.mid),\r\n                mline,\r\n            ]));\r\n            props.currentRemoteDescription = offer;\r\n            props.remoteFingerprints = new SdpTransformManager(offer).getFingerprints();\r\n            await peer.setRemoteDescription(offer);\r\n            await syncMedia(remoteMediaLines, false);\r\n            await calculateSecureCheckCode();\r\n        },\r\n        receiveIceCandidate: async (candidate) => {\r\n            log.info('call receiveIceCandidate', { candidate });\r\n            await peer.addIceCandidate(candidate);\r\n        },\r\n        restartIce,\r\n        getConfiguration: () => peer.getConfiguration(),\r\n        setConfiguration: typeof peer.setConfiguration === 'function'\r\n            ? rtcConfig => peer.setConfiguration(rtcConfig)\r\n            : undefined,\r\n        close: () => {\r\n            log.info('call close');\r\n            localICECandidateQueue.discard();\r\n            props.deferNegotiationCount = 0;\r\n            props.mediaContentMismatchCount = 0;\r\n            remoteMediaLines = new Map();\r\n            Object.keys(timers).forEach(key => {\r\n                clearTimer(key);\r\n            });\r\n            peer.close();\r\n        },\r\n        // Event handlers\r\n        set onConnectionStateChange(handler) {\r\n            peer.onconnectionstatechange = event => {\r\n                clearTimer('connectionState', () => {\r\n                    log.debug('clears the connection state timer', { event });\r\n                });\r\n                if (['disconnected', 'failed'].includes(peer.connectionState)) {\r\n                    log.debug(`waits for emitting connection state change because it is \"${peer.connectionState}\"`, { event });\r\n                    timers.connectionState = window.setTimeout(() => {\r\n                        log.debug('emits connection state change after waiting for ice restart', { event });\r\n                        handler?.(event);\r\n                    }, RecoveryTimeout.ConnectionState);\r\n                }\r\n                else {\r\n                    handler?.(event);\r\n                }\r\n            };\r\n        },\r\n        set onDataChannel(handler) {\r\n            eventHandlers.onDataChannel = handler;\r\n        },\r\n        set onIceCandidate(handler) {\r\n            eventHandlers.onIceCandidate = handler;\r\n        },\r\n        set onIceCandidateError(handler) {\r\n            peer.onicecandidateerror = handler;\r\n        },\r\n        set onIceConnectionStateChange(handler) {\r\n            eventHandlers.iceConnectionStateChange = handler;\r\n        },\r\n        set onIceGatheringStateChange(handler) {\r\n            peer.onicegatheringstatechange = handler ?? null;\r\n        },\r\n        set onNegotiationNeeded(handler) {\r\n            eventHandlers.negotiationNeeded = handler;\r\n        },\r\n        set onSignalingStateChange(handler) {\r\n            eventHandlers.signalingStateChange = handler;\r\n        },\r\n        set onTransceiverChange(handler) {\r\n            eventHandlers.onTransceiverChange = handler;\r\n        },\r\n        set onSecureCheckCode(handler) {\r\n            eventHandlers.onSecureCheckCode = handler;\r\n        },\r\n        set onTrack(handler) {\r\n            eventHandlers.onTrack = handler;\r\n        },\r\n        set onRemoteStreams(handler) {\r\n            eventHandlers.onRemoteStreams = handler;\r\n        },\r\n    };\r\n}\r\n/**\r\n * Logical layer of the Peer Connection for Call/Main, which connecting Signals\r\n * and `RTCPeerConnection` events, @see PCSignals\r\n *\r\n * @param signals - Provide the required signals for communication\r\n * @param options - Configuration for the the Peer Connection\r\n */\r\nexport function createMainPeerConnection(signals, options = {}) {\r\n    const peer = createPeerConnection(options);\r\n    peer.setReference('module', 'MainPeerConnection');\r\n    const { onOfferRequired, ...restSignals } = signals;\r\n    const log = createRefsLog(createGetRefs(peer));\r\n    let subscriptions = [\r\n        // Handler common signals\r\n        ...withSignals(peer)(restSignals),\r\n        onOfferRequired.add(async (param) => {\r\n            log.info('handle onOfferRequired signal', { param });\r\n            // If peer has local MediaStream, `onnegotiationneeded` event will\r\n            // be triggered when `RTCPeerConnection` is ready.\r\n            // RTCPeerConnection['createOffer'] will be called accordingly by\r\n            // the event.\r\n            if (param?.stream && param.target) {\r\n                try {\r\n                    await peer.setLocalStream(param.stream, param.target);\r\n                }\r\n                catch (error) {\r\n                    log.error('setLocalStream failed', { error });\r\n                    peer.negotiationNeeded = true;\r\n                }\r\n            }\r\n            else {\r\n                await peer.negotiate();\r\n            }\r\n        }),\r\n    ];\r\n    const cleanup = () => {\r\n        subscriptions = subscriptions.flatMap(unsubscribe => {\r\n            unsubscribe();\r\n            return [];\r\n        });\r\n    };\r\n    return {\r\n        get peer() {\r\n            return peer.peer;\r\n        },\r\n        get polite() {\r\n            return peer.polite;\r\n        },\r\n        get connectionState() {\r\n            return peer.connectionState;\r\n        },\r\n        get iceConnectionState() {\r\n            return peer.iceConnectionState;\r\n        },\r\n        get iceGatheringState() {\r\n            return peer.iceGatheringState;\r\n        },\r\n        get signalingState() {\r\n            return peer.signalingState;\r\n        },\r\n        get senders() {\r\n            return peer.senders;\r\n        },\r\n        get receivers() {\r\n            return peer.receivers;\r\n        },\r\n        get hasICECandidates() {\r\n            return peer.hasICECandidates;\r\n        },\r\n        get bandwidth() {\r\n            return peer.bandwidth;\r\n        },\r\n        get references() {\r\n            return peer.references;\r\n        },\r\n        set bandwidth(bandwidth) {\r\n            peer.bandwidth = bandwidth;\r\n        },\r\n        get offerOptions() {\r\n            return peer.offerOptions;\r\n        },\r\n        get answerOptions() {\r\n            return peer.answerOptions;\r\n        },\r\n        set offerOptions(newOptions) {\r\n            peer.offerOptions = newOptions;\r\n        },\r\n        set answerOptions(newOptions) {\r\n            peer.answerOptions = newOptions;\r\n        },\r\n        get configs() {\r\n            return peer.configs;\r\n        },\r\n        // Methods\r\n        setLocalStream: peer.setLocalStream,\r\n        setReference(key, value) {\r\n            peer.setReference(key, value);\r\n        },\r\n        getStats: selector => peer.getStats(selector),\r\n        getTransceiverConfigs: peer.getTransceiverConfigs,\r\n        getDataChannelConfigs: peer.getDataChannelConfigs,\r\n        addConfig: peer.addConfig,\r\n        createDataChannel: (label, dataChannelDict) => peer.createDataChannel(label, dataChannelDict),\r\n        restartIce: peer.restartIce,\r\n        getConfiguration: peer.getConfiguration,\r\n        setConfiguration: peer.setConfiguration,\r\n        close: () => {\r\n            cleanup();\r\n            peer.close();\r\n        },\r\n    };\r\n}\r\n", null, null, null, null, null, null, null],
  "mappings": "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",
  "names": ["SocketCloseEventCode", "LogLevels", "LogLevels", "createConsoleLogger", "logger", "createConsoleLogger", "ContentType", "HEADER", "logger", "token", "RecoveryTimeout", "LogLevels", "createConsoleLogger", "logger", "createConsoleLogger", "logger", "_a", "logger", "direction", "streams", "transceiver", "track", "logger", "item", "Codec", "_a", "config", "track", "remoteMediaLines", "LogLevels", "createConsoleLogger", "logger", "createConsoleLogger", "setLogger", "AbortReason", "MAX_RECONNECT_ATTEMPTS", "BACKOFF_BASE_SETTINGS", "createSocketSignals", "BACKOFF_BASE_SETTINGS", "MAX_RECONNECT_ATTEMPTS", "logger", "logger", "VpaasError", "createSocketSignals", "logger", "retry", "MAX_RECONNECT_ATTEMPTS"]
}
